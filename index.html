<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Instant Tax Solutions India - Compliance & Advisory</title>
    
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>

    <script src="https://cdn.tailwindcss.com?plugins=forms"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Phosphor Icons -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    
    <!-- Tailwind Config -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: { 50: '#eff6ff', 100: '#dbeafe', 500: '#3b82f6', 600: '#2563eb', 700: '#1d4ed8', 800: '#1e40af', 900: '#1e3a8a' },
                        slate: { 850: '#1e293b', 900: '#0f172a' },
                        // Custom for App & Checklist
                        tax: { 50: '#f0fdf4', 100: '#dcfce7', 700: '#15803d' },
                        corp: { 50: '#f5f3ff', 100: '#ede9fe', 700: '#6d28d9' },
                        indirect: { 50: '#fff7ed', 100: '#ffedd5', 700: '#c2410c' },
                        warn: { 50: '#fef2f2', 700: '#b91c1c', 200: '#fecaca' },
                        opt: { 50: '#fffbeb', 700: '#b45309', 200: '#fde68a' },
                        labour: { 50: '#fdf2f8', 700: '#be185d', 100: '#fce7f3' },
                        fema: { 50: '#fdf4ff', 700: '#a21caf', 100: '#fae8ff' },
                        primary: { 50: '#eff6ff', 100: '#dbeafe', 500: '#3b82f6', 600: '#2563eb', 700: '#1d4ed8' },
                    },
                    animation: { 'fade-in': 'fadeIn 0.3s ease-out forwards' },
                    keyframes: {
                        fadeIn: { '0%': { opacity: '0', transform: 'translateY(10px)' }, '100%': { opacity: '1', transform: 'translateY(0)' } },
                        fadeInUp: { '0%': { opacity: '0', transform: 'translateY(10px)' }, '100%': { opacity: '1', transform: 'translateY(0)' } }
                    },
                    boxShadow: {
                        'glass': '0 8px 32px 0 rgba(31, 38, 135, 0.07)',
                        'card': '0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)',
                        'card-hover': '0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)',
                    }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; }
        .hidden-section { display: none !important; }
        
        /* New Tool Styles */
        .custom-scroll::-webkit-scrollbar { width: 5px; height: 5px; }
        .custom-scroll::-webkit-scrollbar-track { background: transparent; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        .custom-scroll::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        
        .glass-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(255,255,255,0.3);
        }

        .fade-in-up { animation: fadeInUp 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards; opacity: 0; transform: translateY(10px); }
        
        .tab-active { color: #2563eb; border-bottom: 2px solid #2563eb; background-color: #eff6ff; }
        .tab-inactive { color: #64748b; border-bottom: 2px solid transparent; }
        .tab-inactive:hover { color: #334155; background-color: #f8fafc; }
        
        /* --- CLIENT PORTAL STYLES --- */
        .portal-sidebar { transform: translateX(-100%); transition: transform 0.3s ease-in-out; }
        .portal-sidebar.active { transform: translateX(0); }
        .portal-page { display: none !important; padding-bottom: 80px; animation: fadeIn 0.3s ease-out; }
        .portal-page.active { display: block !important; }
        #portal-login.active { display: flex !important; }
        .progress-ring__circle { transition: stroke-dashoffset 0.5s ease-in-out; transform: rotate(-90deg); transform-origin: 50% 50%; }

        /* Floating Background Animation */
        @keyframes floatUp {
            0% { top: 110%; opacity: 0; transform: rotate(0deg); }
            10% { opacity: 0.15; }
            90% { opacity: 0.15; }
            100% { top: -10%; opacity: 0; transform: rotate(10deg); }
        }
        .float-item {
            position: absolute;
            color: rgba(255,255,255,0.1); 
            font-weight: 800;
            user-select: none;
            pointer-events: none;
            z-index: 1;
            font-family: 'Inter', sans-serif;
            animation: floatUp linear infinite;
        }

        /* Specific Icon Animations */
        @keyframes bounce-slow { 0%, 100% { transform: translateY(-5%); } 50% { transform: translateY(5%); } }
        @keyframes flip-icon { 0%, 100% { transform: rotateY(0deg); } 50% { transform: rotateY(180deg); } }
        .animate-bounce-slow { animation: bounce-slow 3s infinite ease-in-out; }
        .animate-flip { animation: flip-icon 4s infinite ease-in-out; }
        .animate-pulse-slow { animation: pulse 3s infinite cubic-bezier(0.4, 0, 0.6, 1); }
        
        /* 1. Draw Tick Animation */
        .animate-draw-tick path.tick { stroke-dasharray: 24; stroke-dashoffset: 24; animation: drawTick 2s ease-in-out infinite; }
        @keyframes drawTick { 0% { stroke-dashoffset: 24; opacity: 0; } 10% { opacity: 1; } 40% { stroke-dashoffset: 0; } 80% { stroke-dashoffset: 0; opacity: 1; } 100% { stroke-dashoffset: 0; opacity: 0; } }

        /* 2. Coin Spin for Rupee */
        .animate-coin-spin { animation: coinSpin 3s ease-in-out infinite; transform-style: preserve-3d; }
        @keyframes coinSpin { 0%, 10% { transform: rotateY(0); } 50% { transform: rotateY(180deg); } 90%, 100% { transform: rotateY(360deg); } }
        
        @media print {
            aside, nav, #tabsContainer, #banners, #mobileToast, #miniDashboard, #searchInputContainer, .no-print { display: none !important; }
            main { margin: 0; padding: 0; overflow: visible; width: 100%; }
            body { height: auto; overflow: visible; background: white; }
            #listSection { display: block !important; }
            #dashboardSection { display: none !important; }
        }
    </style>
</head>
<body class="min-h-screen flex flex-col bg-slate-50 text-gray-800 overflow-hidden">

<!-- ============================================ -->
<!-- MARKETING SITE WRAPPER (Your Original Site)  -->
<!-- ============================================ -->
<div id="marketing-site" class="flex flex-col h-screen overflow-hidden">

    <!-- Global Navigation -->
    <nav class="bg-white/90 backdrop-blur border-b border-gray-200 sticky top-0 z-40 shadow-sm flex-none h-16 transition-all duration-300" id="navbar">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-full">
            <div class="flex justify-between items-center h-full">
                
                <div class="relative h-12 w-64 cursor-pointer group" onclick="router('home')">
                    
                    <div id="brand-logo" class="absolute inset-0 flex items-center transition-all duration-500 ease-in-out opacity-100 translate-y-0">
                        <svg viewBox="0 0 300 80" class="h-10 w-auto" xmlns="http://www.w3.org/2000/svg">
                            <style>
                                .logo-text { font-family: 'Inter', sans-serif; fill: #001A4B; }
                                .logo-sub { font-family: 'Inter', sans-serif; fill: #001A4B; }
                                .logo-accent { stroke: #25D366; stroke-width: 4; fill: none; stroke-linecap: round; stroke-linejoin: round; }
                            </style>
                            <text x="5" y="45" class="logo-text" font-weight="800" font-size="38" letter-spacing="-1">Instant Tax</text>
                            <path d="M 5 55 L 210 55 L 225 70 L 255 35" class="logo-accent" />
                            <text x="105" y="72" class="logo-sub" font-weight="600" font-size="14" text-anchor="middle">Solutions India</text>
                        </svg>
                    </div>

                    <div id="brand-vision" class="absolute inset-0 flex items-center transition-all duration-500 ease-in-out opacity-0 translate-y-4">
                        <div class="border-l-4 border-brand-600 pl-3">
                            <p class="text-[10px] font-bold text-gray-400 uppercase tracking-widest leading-none mb-0.5">OUR VISION</p>
                            <p class="text-sm font-bold text-gray-800 italic">"Simplifying Compliance"</p>
                        </div>
                    </div>

                </div>

                <div class="hidden md:flex items-center space-x-8">
                    <button onclick="router('home')" class="text-gray-600 hover:text-brand-600 font-medium transition text-sm">Home</button>
                    <button onclick="router('checklist')" class="text-gray-600 hover:text-brand-600 font-medium transition text-sm">Checklist Tool</button>
                    <button onclick="router('pricing')" class="text-gray-600 hover:text-brand-600 font-medium transition text-sm">Services & Pricing</button>
                    <div class="h-6 w-px bg-gray-300 mx-2"></div>
                    <button onclick="startPortal()" class="text-brand-700 hover:text-brand-900 font-bold transition text-sm flex items-center gap-2">
                        <i class="fa-solid fa-lock"></i> Client Login
                    </button>
                    <button onclick="openEnquiryModal('Expert Consultation')" class="bg-brand-600 text-white px-5 py-2 rounded-full hover:bg-brand-700 transition shadow-md text-sm font-semibold">Contact Expert</button>
                </div>
                
                <div class="md:hidden flex items-center gap-4">
                    <button onclick="startPortal()" class="text-brand-600 font-bold text-sm">Login</button>
                    <button onclick="toggleMobileMenu()" class="text-gray-500 hover:text-gray-700 p-2"><i class="fa-solid fa-bars text-xl"></i></button>
                </div>
            </div>
        </div>
        <div id="mobile-menu" class="hidden md:hidden bg-white border-b border-gray-100 px-4 py-2 space-y-2">
            <button onclick="router('home')" class="block w-full text-left py-2 text-gray-600">Home</button>
            <button onclick="router('checklist')" class="block w-full text-left py-2 text-gray-600">Checklist Tool</button>
            <button onclick="router('pricing')" class="block w-full text-left py-2 text-gray-600">Pricing</button>
        </div>
    </nav>

    <!-- ================= VIEW: HOME PAGE (REDESIGNED) ================= -->
    <div id="view-home" class="view-section h-[calc(100vh-64px)] overflow-y-auto custom-scroll">
        
        <!-- Hero Section -->
        <div class="bg-gradient-to-b from-white to-slate-50 pt-20 pb-24">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
                
                <!-- Badge -->
                <div class="inline-flex items-center px-3 py-1 rounded-full border border-brand-200 bg-brand-50 text-brand-700 text-xs font-bold mb-8 animate-fade-in">
                    <span class="w-2 h-2 rounded-full bg-brand-500 mr-2 animate-pulse"></span>
                    FY 2024-25 COMPLIANCE READY
                </div>

                <!-- Headline -->
                <h1 class="text-4xl md:text-6xl font-extrabold text-slate-900 tracking-tight mb-6 animate-fade-in" style="animation-delay: 100ms">
                    Simplified Tax <br class="hidden md:block" />
                    <!-- Fixed Gradient Class below -->
                    <span class="text-transparent bg-clip-text bg-gradient-to-r from-brand-600 to-brand-800">Compliance India</span>
                </h1>
                
                <p class="max-w-2xl mx-auto text-lg text-slate-500 mb-12 animate-fade-in" style="animation-delay: 200ms">
                    Navigate the complex regulatory landscape with our automated tools and expert support. From GST to ITR, we handle it all.
                </p>

                <!-- Interactive Action Cards (The Long Buttons) -->
                <div class="max-w-3xl mx-auto space-y-5 animate-fade-in" style="animation-delay: 300ms">
                    
                    <!-- 1. Checklist Tool (With Drawing Tick Animation) -->
                    <div onclick="router('checklist')" class="group relative w-full bg-gradient-to-r from-white to-brand-50/30 rounded-3xl p-6 sm:p-8 border-2 border-slate-100 shadow-lg hover:shadow-2xl hover:border-brand-500 transition-all duration-300 cursor-pointer overflow-hidden transform hover:-translate-y-1">
                        <div class="relative flex items-center justify-between z-10">
                            <div class="flex items-center gap-6">
                                <div class="w-16 h-16 rounded-2xl bg-brand-100 text-brand-600 flex items-center justify-center text-3xl group-hover:scale-110 transition-transform shadow-inner">
                                    <svg class="w-8 h-8 animate-draw-tick" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7" class="tick" />
                                    </svg>
                                </div>
                                <div class="text-left">
                                    <h3 class="text-xl font-extrabold text-slate-900 group-hover:text-brand-700 transition-colors">Regulatory Checklist</h3>
                                    <p class="text-sm font-medium text-slate-500 group-hover:text-slate-700">Generate a free compliance report instantly</p>
                                </div>
                            </div>
                            <div class="hidden sm:flex w-12 h-12 rounded-full bg-white border border-slate-200 items-center justify-center text-slate-400 group-hover:bg-brand-600 group-hover:text-white group-hover:border-transparent transition-all shadow-md">
                                <i class="ph ph-arrow-right font-bold text-lg"></i>
                            </div>
                        </div>
                    </div>

                    <!-- 2. Services & Pricing (With Coin Spin Animation) -->
                    <div onclick="router('pricing')" class="group relative w-full bg-gradient-to-r from-white to-green-50/30 rounded-3xl p-6 sm:p-8 border-2 border-slate-100 shadow-lg hover:shadow-2xl hover:border-green-500 transition-all duration-300 cursor-pointer overflow-hidden transform hover:-translate-y-1">
                        <div class="relative flex items-center justify-between z-10">
                            <div class="flex items-center gap-6">
                                <div class="w-16 h-16 rounded-2xl bg-green-100 text-green-600 flex items-center justify-center text-3xl group-hover:scale-110 transition-transform shadow-inner">
                                    <svg class="w-8 h-8 animate-coin-spin" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 8h6m-5 0a3 3 0 110 6H9l3 3m-3-6h6m6 1a9 9 0 11-18 0 9 9 0 0118 0z" />
                                    </svg>
                                </div>
                                <div class="text-left">
                                    <h3 class="text-xl font-extrabold text-slate-900 group-hover:text-green-700 transition-colors">Services & Pricing</h3>
                                    <p class="text-sm font-medium text-slate-500 group-hover:text-slate-700">Transparent rates for ITR, GST, and incorporation</p>
                                </div>
                            </div>
                            <div class="hidden sm:flex w-12 h-12 rounded-full bg-white border border-slate-200 items-center justify-center text-slate-400 group-hover:bg-green-600 group-hover:text-white group-hover:border-transparent transition-all shadow-md">
                                <i class="ph ph-arrow-right font-bold text-lg"></i>
                            </div>
                        </div>
                    </div>

                    <!-- 3. Client Login -->
                    <div onclick="startPortal()" class="group relative w-full bg-gradient-to-r from-white to-slate-100 rounded-3xl p-6 sm:p-8 border-2 border-slate-100 shadow-lg hover:shadow-2xl hover:border-slate-800 transition-all duration-300 cursor-pointer overflow-hidden transform hover:-translate-y-1">
                        <div class="relative flex items-center justify-between z-10">
                            <div class="flex items-center gap-6">
                                <div class="w-16 h-16 rounded-2xl bg-slate-200 text-slate-800 flex items-center justify-center text-3xl group-hover:scale-110 transition-transform shadow-inner">
                                    <i class="ph ph-user-circle animate-pulse-slow"></i>
                                </div>
                                <div class="text-left">
                                    <h3 class="text-xl font-extrabold text-slate-900">Client Portal Login</h3>
                                    <p class="text-sm font-medium text-slate-500 group-hover:text-slate-700">Access your dashboard, filings, and history</p>
                                </div>
                            </div>
                            <div class="hidden sm:flex w-12 h-12 rounded-full bg-white border border-slate-200 items-center justify-center text-slate-400 group-hover:bg-slate-800 group-hover:text-white group-hover:border-transparent transition-all shadow-md">
                                <i class="ph ph-sign-in font-bold text-lg"></i>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>

        <!-- Why Choose Us Section -->
        <div class="bg-white border-t border-slate-200 py-16">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center mb-12">
                    <h2 class="text-2xl font-bold text-slate-900 uppercase tracking-wide">Why Instant Tax?</h2>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <div class="p-6 bg-slate-50 rounded-2xl border border-slate-100 text-center hover:bg-white hover:shadow-md transition">
                        <div class="mx-auto w-14 h-14 bg-white rounded-full flex items-center justify-center text-green-600 mb-4 text-2xl shadow-sm border border-slate-100">
                            <i class="fa-solid fa-calendar-check"></i>
                        </div>
                        <h4 class="font-bold text-slate-900 text-lg">Always Compliant</h4>
                        <p class="text-sm text-slate-500 mt-2">Real-time updates with the latest Finance Acts.</p>
                    </div>
                    <div class="p-6 bg-slate-50 rounded-2xl border border-slate-100 text-center hover:bg-white hover:shadow-md transition">
                        <div class="mx-auto w-14 h-14 bg-white rounded-full flex items-center justify-center text-brand-600 mb-4 text-2xl shadow-sm border border-slate-100">
                            <i class="fa-solid fa-user-tie"></i>
                        </div>
                        <h4 class="font-bold text-slate-900 text-lg">Expert Assisted</h4>
                        <p class="text-sm text-slate-500 mt-2">Verified CAs review every single filing.</p>
                    </div>
                    <div class="p-6 bg-slate-50 rounded-2xl border border-slate-100 text-center hover:bg-white hover:shadow-md transition">
                        <div class="mx-auto w-14 h-14 bg-white rounded-full flex items-center justify-center text-purple-600 mb-4 text-2xl shadow-sm border border-slate-100">
                            <i class="fa-solid fa-bolt"></i>
                        </div>
                        <h4 class="font-bold text-slate-900 text-lg">Fast Turnaround</h4>
                        <p class="text-sm text-slate-500 mt-2">Automated workflows for speed and accuracy.</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Footer -->
        <footer class="bg-slate-900 text-slate-400 py-8 text-center text-sm border-t border-slate-800">
            <p>&copy; 2025 Instant Tax Solutions India. All rights reserved.</p>
        </footer>
    </div>

    <!-- ================= VIEW: CHECKLIST TOOL v2 ================= -->
    <div id="view-checklist" class="view-section hidden-section h-[calc(100vh-64px)] flex flex-col relative text-slate-800 bg-slate-50">
        <!-- TOOL TOP TOOLBAR -->
        <header class="glass-panel h-16 z-30 flex-none no-print shadow-sm bg-white/95">
            <div class="h-full px-4 sm:px-6 flex items-center justify-between max-w-[1600px] mx-auto">
                <div class="flex items-center gap-2">
                    <span class="text-sm font-medium text-slate-500">Tools</span>
                    <i class="ph ph-caret-right text-xs text-slate-400"></i>
                    <h1 class="text-sm font-bold text-slate-900">Compliance Master</h1>
                </div>
                
                <div class="flex items-center gap-3">
                    <button onclick="if(window.app) window.app.downloadCSV()" class="hidden sm:flex items-center gap-2 px-3 py-1.5 bg-white border border-slate-200 rounded-lg text-xs font-semibold text-slate-600 hover:border-primary-500 hover:text-primary-600 transition-all shadow-sm">
                        <i class="ph ph-download-simple text-sm"></i> Export
                    </button>
                    <button onclick="window.app.toggleSidebar()" class="lg:hidden p-2 text-slate-600 hover:bg-slate-100 rounded-lg">
                        <i class="ph ph-faders text-xl"></i>
                    </button>
                </div>
            </div>
        </header>

        <div class="flex flex-1 overflow-hidden max-w-[1600px] mx-auto w-full relative">
            <div id="drawerBackdrop" onclick="if(window.app) window.app.toggleSidebar()" class="fixed inset-0 bg-slate-900/20 backdrop-blur-sm z-40 hidden lg:hidden transition-opacity opacity-0 no-print"></div>
            
            <aside id="configSidebar" class="fixed inset-y-0 left-0 z-50 w-80 bg-white border-r border-slate-200 shadow-2xl lg:shadow-none transform -translate-x-full lg:translate-x-0 lg:static transition-transform duration-300 flex flex-col h-full no-print">
                <div class="p-4 border-b border-slate-100 flex items-center justify-between lg:hidden">
                    <span class="font-bold text-slate-900">Configure Entity</span>
                    <button onclick="window.app.toggleSidebar()" class="text-slate-400"><i class="ph ph-x text-xl"></i></button>
                </div>
                <div class="flex-1 overflow-y-auto custom-scroll p-5 space-y-8">
                    <div class="space-y-3">
                        <h3 class="text-xs font-bold text-slate-400 uppercase tracking-wider flex items-center gap-2"><i class="ph ph-buildings"></i> Profile</h3>
                        <select id="entityType" onchange="window.app.updateFields()" class="w-full bg-slate-50 border border-slate-200 text-slate-700 text-sm rounded-lg p-2.5">
                            <option value="Private Limited">Private Limited Co.</option>
                            <option value="LLP">LLP / Partnership</option>
                            <option value="Individual">Individual / Proprietor</option>
                            <option value="Public Limited">Public Limited Co.</option>
                            <option value="Listed">Listed Company</option>
                            <option value="Section 8">Section 8 / Trust</option>
                            <option value="Foreign Co">Foreign Subsidiary</option>
                        </select>
                        <div id="indivTypeField" class="hidden animate-fade-in space-y-2">
                            <select id="indivType" class="w-full bg-slate-50 border border-slate-200 text-slate-600 text-xs rounded-lg p-2.5">
                                <option value="Business">Business (Trader/Mfr)</option>
                                <option value="Professional">Professional</option>
                            </select>
                            <label class="flex items-center p-2 rounded-lg border border-slate-200 hover:bg-slate-50 cursor-pointer"><input type="checkbox" id="isDirector" class="w-4 h-4 text-brand-600 rounded"><span class="ml-2 text-xs font-medium text-slate-600">Do you hold a DIN?</span></label>
                        </div>
                    </div>
                    <div class="space-y-3">
                        <h3 class="text-xs font-bold text-slate-400 uppercase tracking-wider flex items-center gap-2"><i class="ph ph-chart-line-up"></i> Financials</h3>
                        <div class="grid grid-cols-1 gap-3">
                            <div>
                                <label class="text-[10px] text-slate-500 font-medium mb-1 block">Annual Turnover</label>
                                <select id="turnover" class="w-full bg-slate-50 border border-slate-200 text-slate-600 text-xs rounded-lg p-2.5">
                                    <option value="1500000">&lt; ₹20 Lakhs</option>
                                    <option value="4000000">₹20L - ₹40L</option>
                                    <option value="12000000">₹40L - ₹1.5 Cr</option>
                                    <option value="25000000">₹1.5 Cr - ₹3 Cr</option>
                                    <option value="75000000">₹5 Cr - ₹10 Cr</option>
                                    <option value="2000000000">₹10 Cr - ₹500 Cr</option>
                                    <option value="6000000000"> > ₹500 Cr</option>
                                </select>
                            </div>
                            <div id="capitalField">
                                <label class="text-[10px] text-slate-500 font-medium mb-1 block">Paid-up Capital</label>
                                <select id="capital" class="w-full bg-slate-50 border border-slate-200 text-slate-600 text-xs rounded-lg p-2.5">
                                    <option value="100000">Small (&lt; ₹10L)</option>
                                    <option value="50000000">Medium (&lt; ₹10 Cr)</option>
                                    <option value="150000000">Large (&gt; ₹10 Cr)</option>
                                    <option value="550000000">Very Large (&gt; ₹50 Cr)</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="space-y-3">
                        <h3 class="text-xs font-bold text-slate-400 uppercase tracking-wider flex items-center gap-2"><i class="ph ph-sliders"></i> Scope</h3>
                        <div class="grid grid-cols-2 gap-2">
                            <label class="flex items-center gap-2 p-2 border rounded hover:bg-slate-50 cursor-pointer"><input type="checkbox" id="hasGST" checked class="text-brand-600 rounded"> <span class="text-xs">GST Reg</span></label>
                            <label class="flex items-center gap-2 p-2 border rounded hover:bg-slate-50 cursor-pointer"><input type="checkbox" id="hasTAN" checked class="text-brand-600 rounded"> <span class="text-xs">TAN/TDS</span></label>
                            <label class="flex items-center gap-2 p-2 border rounded hover:bg-slate-50 cursor-pointer"><input type="checkbox" id="hasPayroll" class="text-brand-600 rounded"> <span class="text-xs">Payroll</span></label>
                            <label class="flex items-center gap-2 p-2 border rounded hover:bg-slate-50 cursor-pointer"><input type="checkbox" id="isExport" class="text-brand-600 rounded"> <span class="text-xs">Export/SEZ</span></label>
                            <label class="flex items-center gap-2 p-2 border rounded hover:bg-slate-50 cursor-pointer"><input type="checkbox" id="isStartup" class="text-brand-600 rounded"> <span class="text-xs">Startup</span></label>
                            <label class="flex items-center gap-2 p-2 border rounded hover:bg-slate-50 cursor-pointer"><input type="checkbox" id="hasMSME" class="text-brand-600 rounded"> <span class="text-xs">MSME</span></label>
                            <label class="flex items-center gap-2 p-2 border rounded hover:bg-slate-50 cursor-pointer"><input type="checkbox" id="hasFDI" class="text-brand-600 rounded"> <span class="text-xs">FDI/TP</span></label>
                            <label class="flex items-center gap-2 p-2 border rounded hover:bg-slate-50 cursor-pointer"><input type="checkbox" id="hasRPT" class="text-brand-600 rounded"> <span class="text-xs">Rel. Party</span></label>
                            <label class="flex items-center gap-2 p-2 border rounded hover:bg-slate-50 cursor-pointer"><input type="checkbox" id="isNewInc" class="text-brand-600 rounded"> <span class="text-xs">New Inc.</span></label>
                        </div>
                    </div>
                </div>
                <div class="p-4 border-t border-slate-200 bg-slate-50/50 backdrop-blur-sm">
                    <button id="runBtn" onclick="window.app.manualRun()" class="w-full bg-slate-900 hover:bg-black text-white font-semibold py-3.5 rounded-xl shadow-lg transform active:scale-95 transition-all flex items-center justify-center gap-2">
                        <i class="ph ph-lightning text-lg"></i> Run Analysis
                    </button>
                    <button onclick="if(window.app) window.app.resetAll()" class="mt-2 w-full text-xs text-slate-400 hover:text-slate-600 underline text-center">Reset to Defaults</button>
                </div>
            </aside>

            <main id="mainContent" class="flex-1 flex flex-col min-w-0 bg-slate-50/50 relative overflow-hidden scroll-smooth">
                <div id="initialInstruction" class="flex-1 flex flex-col items-center justify-center p-8 text-center h-full animate-fade-in">
                    <div class="w-24 h-24 bg-brand-50 rounded-full flex items-center justify-center mb-6 shadow-sm ring-1 ring-brand-100"><i class="ph ph-sliders text-4xl text-brand-600"></i></div>
                    <h2 class="text-2xl font-bold text-slate-900 mb-3">Configure Your Profile</h2>
                    <p class="text-slate-500 max-w-md mx-auto leading-relaxed mb-8 text-sm">Select your entity type and financials using the sidebar to generate a checklist.</p>
                    <button onclick="if(window.app) window.app.toggleSidebar()" class="lg:hidden inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-xl text-white bg-brand-600 shadow-lg">Open Filters</button>
                </div>

                <div id="tabsWrapper" class="bg-white border-b border-slate-200 shadow-sm z-20 no-print sticky top-0 hidden">
                    <div class="px-6 py-4">
                        <div class="relative max-w-2xl group">
                            <i class="ph ph-magnifying-glass absolute left-3.5 top-3 text-slate-400 text-lg"></i>
                            <input type="text" id="searchInput" onkeyup="window.app.render()" placeholder="Search form, section, or compliance..." class="w-full pl-10 pr-4 py-2.5 bg-slate-100 border-transparent border rounded-xl text-sm font-medium focus:ring-2 focus:ring-brand-500">
                        </div>
                    </div>
                    <nav class="flex overflow-x-auto custom-scroll px-6 gap-4" id="tabsContainer"></nav>
                </div>

                <div id="dashboardSection" class="hidden flex-1 overflow-y-auto custom-scroll p-4 sm:p-8 space-y-8">
                    <div class="bg-gradient-to-r from-slate-800 to-slate-900 rounded-2xl p-6 sm:p-8 text-white shadow-xl flex flex-col sm:flex-row items-center justify-between gap-6 relative overflow-hidden">
                        <div class="relative z-10">
                            <h2 class="text-2xl font-bold mb-1">Compliance Applicable</h2>
                            <p class="text-slate-400 text-sm">FY 2025-26 Legal Framework. <span class="text-brand-400 font-semibold" id="entityDisplay">Private Limited</span></p>
                        </div>
                        <div class="relative z-10 flex items-center gap-6">
                             <div class="text-right"><div class="text-3xl font-bold" id="totalCount">0</div><div class="text-[10px] uppercase tracking-wider text-slate-400">Total Oblg.</div></div>
                             <div class="h-10 w-px bg-white/20"></div>
                             <div class="text-right"><div class="text-3xl font-bold text-red-400" id="highRiskCount">0</div><div class="text-[10px] uppercase tracking-wider text-slate-400">High Penalty</div></div>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <div class="bg-white p-6 rounded-2xl border border-slate-100 shadow-card flex flex-col items-center justify-start min-h-[320px]">
                            <h3 class="text-xs font-bold text-slate-400 uppercase tracking-widest mb-6 self-start flex items-center gap-2"><i class="ph ph-chart-pie-slice"></i> Distribution</h3>
                            <div class="w-full h-56 relative flex-shrink-0"><canvas id="complianceChart"></canvas></div>
                            <div id="chartSummary" class="w-full mt-6 pt-4 border-t border-slate-100 grid grid-cols-2 gap-2 text-xs"></div>
                        </div>
                        <div class="lg:col-span-2 grid grid-cols-2 sm:grid-cols-3 gap-4" id="categoryGrid"></div>
                    </div>
                </div>

                <div id="listSection" class="hidden flex-1 overflow-y-auto custom-scroll p-4 sm:p-6 pb-24">
                    <div id="resultsHeader" class="flex items-center justify-between mb-4">
                        <h3 class="font-bold text-lg text-slate-800">Compliance Checklist</h3>
                        <span id="resultsCount" class="text-xs font-semibold bg-slate-200 text-slate-600 px-3 py-1 rounded-full">0 Found</span>
                    </div>
                    <div id="complianceBody" class="space-y-3"></div>
                </div>
            </main>
        </div>
        
        <!-- Info Modal -->
        <div id="infoModal" class="fixed inset-0 z-[100] hidden" aria-labelledby="modal-title" role="dialog" aria-modal="true">
            <div class="fixed inset-0 bg-slate-900/60 backdrop-blur-sm transition-opacity" onclick="window.app.closeModal()"></div>
            <div class="fixed inset-0 z-10 overflow-y-auto">
                <div class="flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0">
                    <div class="relative transform overflow-hidden rounded-2xl bg-white text-left shadow-2xl transition-all sm:my-8 w-full sm:max-w-xl h-[500px] flex flex-col" id="modalContent">
                        <div class="bg-white px-6 py-5 border-b border-slate-100 flex-none">
                            <div class="flex items-start gap-4">
                                <div class="flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-brand-50"><i class="ph ph-info text-2xl text-brand-600"></i></div>
                                <div class="flex-1">
                                    <h3 class="text-lg font-bold leading-6 text-slate-900" id="modalTitle">Title</h3>
                                    <div class="mt-1 flex gap-2">
                                        <span id="modalAct" class="text-[10px] font-bold bg-slate-100 text-slate-600 px-2 py-0.5 rounded uppercase">Act</span>
                                        <span id="modalForm" class="text-[10px] font-bold bg-blue-50 text-blue-600 px-2 py-0.5 rounded font-mono border border-blue-100">Form</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="flex-1 overflow-y-auto custom-scroll px-6 py-4 space-y-5">
                            <div class="bg-slate-50 p-4 rounded-xl border border-slate-100">
                                <label class="text-[10px] font-bold text-slate-400 uppercase tracking-wider block mb-1.5">Description</label>
                                <p class="text-sm text-slate-700 leading-relaxed" id="modalDesc">...</p>
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div class="p-3 rounded-lg border border-slate-100 bg-white">
                                    <label class="text-[10px] font-bold text-slate-400 uppercase tracking-wider block mb-1">Due Date</label>
                                    <p class="text-sm font-bold text-slate-900" id="modalDate">...</p>
                                </div>
                                <div class="p-3 rounded-lg border border-slate-100 bg-white">
                                    <label class="text-[10px] font-bold text-slate-400 uppercase tracking-wider block mb-1">Frequency</label>
                                    <p class="text-sm font-medium text-slate-900" id="modalFreq">...</p>
                                </div>
                            </div>
                            <div class="bg-red-50 p-4 rounded-xl border border-red-100 flex gap-3 items-start">
                                <i class="ph ph-warning text-red-600 text-lg mt-0.5 flex-shrink-0"></i>
                                <div>
                                    <label class="text-[10px] font-bold text-red-700 uppercase tracking-wider block mb-1">Penalty Risk</label>
                                    <p class="text-xs text-red-800 font-medium leading-relaxed" id="modalPenalty">...</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-slate-50 px-6 py-4 border-t border-slate-100 flex-none flex flex-col-reverse sm:flex-row-reverse gap-3 sm:gap-0">
                            <button class="inline-flex w-full sm:w-auto justify-center rounded-xl bg-slate-900 px-4 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-black sm:ml-3 transition-colors" onclick="window.app.closeModal()">Close</button>
                            <button class="inline-flex w-full sm:w-auto justify-center rounded-xl bg-brand-600 px-4 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-brand-700 transition-colors" onclick="window.app.getPricing()">Get Pricing</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ================= VIEW: PRICING (RESTORED FULLY) ================= -->
    <div id="view-pricing" class="view-section hidden-section h-[calc(100vh-64px)] overflow-y-auto">
        <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="mb-6 flex items-center text-sm text-gray-500">
                <button onclick="router('home')" class="hover:text-brand-600">Home</button>
                <i class="fa-solid fa-chevron-right mx-2 text-xs"></i>
                <span class="font-semibold text-gray-900">Pricing</span>
            </div>
            <div class="text-center max-w-3xl mx-auto mb-12">
                <h2 class="text-3xl font-extrabold text-gray-900">Transparent Service Rates</h2>
                <p class="mt-4 text-lg text-gray-500">Choose the specific service you need. No bundled nonsense, just clear, flat-fee pricing.</p>
            </div>
            <div class="flex justify-center mb-8">
                <div class="bg-gray-100 p-1 rounded-xl inline-flex overflow-x-auto max-w-full">
                    <button onclick="switchPricing('subscription')" id="tab-subscription" class="whitespace-nowrap px-6 py-2.5 rounded-lg text-sm font-medium transition-all bg-white text-gray-900 shadow-sm ring-1 ring-black/5">Return filings</button>
                    <button onclick="switchPricing('bookkeeping')" id="tab-bookkeeping" class="whitespace-nowrap px-6 py-2.5 rounded-lg text-sm font-medium transition-all text-gray-500 hover:text-gray-900">Bookkeeping</button>
                    <button onclick="switchPricing('litigation')" id="tab-litigation" class="whitespace-nowrap px-6 py-2.5 rounded-lg text-sm font-medium transition-all text-gray-500 hover:text-gray-900">Litigation</button>
                    <button onclick="switchPricing('advisory')" id="tab-advisory" class="whitespace-nowrap px-6 py-2.5 rounded-lg text-sm font-medium transition-all text-gray-500 hover:text-gray-900">Advisory</button>
                </div>
            </div>

            <!-- Content: Subscription -->
            <div id="pricing-subscription" class="pricing-content animate-fade-in">
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition">
                        <div class="h-10 w-10 bg-blue-100 rounded-lg flex items-center justify-center text-blue-600 mb-4"><i class="fa-solid fa-file-invoice"></i></div>
                        <h3 class="text-lg font-bold text-gray-900">Income Tax Return</h3>
                        <p class="text-sm text-gray-500 mt-2 h-10">Filing of ITR-1 to ITR-6 assisted by CA.</p>
                        <div class="mt-4 pt-4 border-t border-gray-100">
                            <span class="text-2xl font-bold text-gray-900">₹1,500 onwards</span>
                            <span class="text-gray-400 text-sm block">per filing</span>
                            <button onclick="openEnquiryModal('Income Tax Return')" class="mt-4 w-full bg-white border border-gray-300 text-gray-700 font-semibold py-2 rounded-lg hover:bg-gray-50 transition text-sm">Enquire Now</button>
                        </div>
                    </div>
                    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition">
                        <div class="h-10 w-10 bg-indigo-100 rounded-lg flex items-center justify-center text-indigo-600 mb-4"><i class="fa-solid fa-percent"></i></div>
                        <h3 class="text-lg font-bold text-gray-900">TDS / TCS Returns</h3>
                        <p class="text-sm text-gray-500 mt-2 h-10">Quarterly filing of Form 24Q, 26Q.</p>
                        <div class="mt-4 pt-4 border-t border-gray-100">
                            <span class="text-2xl font-bold text-gray-900">₹2,000 onwards</span>
                            <span class="text-gray-400 text-sm block">per quarter</span>
                            <button onclick="openEnquiryModal('TDS Returns')" class="mt-4 w-full bg-white border border-gray-300 text-gray-700 font-semibold py-2 rounded-lg hover:bg-gray-50 transition text-sm">Enquire Now</button>
                        </div>
                    </div>
                    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition">
                        <div class="h-10 w-10 bg-green-100 rounded-lg flex items-center justify-center text-green-600 mb-4"><i class="fa-solid fa-shop"></i></div>
                        <h3 class="text-lg font-bold text-gray-900">GST Filings</h3>
                        <p class="text-sm text-gray-500 mt-2 h-10">Monthly GSTR-1 & 3B filing support.</p>
                        <div class="mt-4 pt-4 border-t border-gray-100">
                            <span class="text-2xl font-bold text-gray-900">₹1,000 onwards</span>
                            <span class="text-gray-400 text-sm block">per month</span>
                            <button onclick="openEnquiryModal('GST Filings')" class="mt-4 w-full bg-white border border-gray-300 text-gray-700 font-semibold py-2 rounded-lg hover:bg-gray-50 transition text-sm">Enquire Now</button>
                        </div>
                    </div>
                    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition">
                        <div class="h-10 w-10 bg-orange-100 rounded-lg flex items-center justify-center text-orange-600 mb-4"><i class="fa-solid fa-building"></i></div>
                        <h3 class="text-lg font-bold text-gray-900">Company Incorporation</h3>
                        <p class="text-sm text-gray-500 mt-2 h-10">Pvt Ltd / LLP Registration (pro fees only).</p>
                        <div class="mt-4 pt-4 border-t border-gray-100">
                            <span class="text-2xl font-bold text-gray-900">₹7,000 onwards</span>
                            <span class="text-gray-400 text-sm block">one-time</span>
                            <button onclick="openEnquiryModal('Incorporation')" class="mt-4 w-full bg-white border border-gray-300 text-gray-700 font-semibold py-2 rounded-lg hover:bg-gray-50 transition text-sm">Enquire Now</button>
                        </div>
                    </div>
                    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition">
                        <div class="h-10 w-10 bg-teal-100 rounded-lg flex items-center justify-center text-teal-600 mb-4"><i class="fa-solid fa-book"></i></div>
                        <h3 class="text-lg font-bold text-gray-900">MCA Annual Filing</h3>
                        <p class="text-sm text-gray-500 mt-2 h-10">AOC-4 and MGT-7 filings.</p>
                        <div class="mt-4 pt-4 border-t border-gray-100">
                            <span class="text-2xl font-bold text-gray-900">₹5,000 onwards</span>
                            <span class="text-gray-400 text-sm block">per year</span>
                            <button onclick="openEnquiryModal('MCA Filing')" class="mt-4 w-full bg-white border border-gray-300 text-gray-700 font-semibold py-2 rounded-lg hover:bg-gray-50 transition text-sm">Enquire Now</button>
                        </div>
                    </div>
                    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition">
                        <div class="h-10 w-10 bg-purple-100 rounded-lg flex items-center justify-center text-purple-600 mb-4"><i class="fa-solid fa-globe"></i></div>
                        <h3 class="text-lg font-bold text-gray-900">Transfer Pricing</h3>
                        <p class="text-sm text-gray-500 mt-2 h-10">Documentation & Filing Form 3CEB.</p>
                        <div class="mt-4 pt-4 border-t border-gray-100">
                            <span class="text-2xl font-bold text-gray-900">₹15,000 onwards</span>
                            <span class="text-gray-400 text-sm block">per filing</span>
                            <button onclick="openEnquiryModal('Transfer Pricing')" class="mt-4 w-full bg-white border border-gray-300 text-gray-700 font-semibold py-2 rounded-lg hover:bg-gray-50 transition text-sm">Enquire Now</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Content: Bookkeeping -->
            <div id="pricing-bookkeeping" class="pricing-content hidden-section animate-fade-in">
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition">
                        <div class="h-10 w-10 bg-cyan-100 rounded-lg flex items-center justify-center text-cyan-600 mb-4"><i class="fa-solid fa-book-open"></i></div>
                        <h3 class="text-lg font-bold text-gray-900">Monthly Bookkeeping</h3>
                        <p class="text-sm text-gray-500 mt-2 h-10">Recording transactions, categorization.</p>
                        <div class="mt-4 pt-4 border-t border-gray-100">
                            <!-- Updated Price -->
                            <span class="text-2xl font-bold text-gray-900">₹25,000 onwards</span>
                            <span class="text-gray-400 text-sm block">per month</span>
                            <button onclick="openEnquiryModal('Bookkeeping')" class="mt-4 w-full bg-white border border-gray-300 text-gray-700 font-semibold py-2 rounded-lg">Enquire Now</button>
                        </div>
                    </div>
                     <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition">
                        <div class="h-10 w-10 bg-emerald-100 rounded-lg flex items-center justify-center text-emerald-600 mb-4"><i class="fa-solid fa-file-contract"></i></div>
                        <h3 class="text-lg font-bold text-gray-900">Financial Statements</h3>
                        <p class="text-sm text-gray-500 mt-2 h-10">Balance Sheet, P&L, Cash Flow.</p>
                        <div class="mt-4 pt-4 border-t border-gray-100">
                             <!-- Updated Price -->
                            <span class="text-2xl font-bold text-gray-900">₹9,000 onwards</span>
                            <span class="text-gray-400 text-sm block">per year</span>
                            <button onclick="openEnquiryModal('Financials')" class="mt-4 w-full bg-white border border-gray-300 text-gray-700 font-semibold py-2 rounded-lg">Enquire Now</button>
                        </div>
                    </div>
                    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition">
                         <div class="h-10 w-10 bg-pink-100 rounded-lg flex items-center justify-center text-pink-600 mb-4"><i class="fa-solid fa-users-gear"></i></div>
                        <h3 class="text-lg font-bold text-gray-900">Payroll Processing</h3>
                         <p class="text-sm text-gray-500 mt-2 h-10">Salary slips and compliance.</p>
                        <div class="mt-4 pt-4 border-t border-gray-100">
                             <!-- Updated Price -->
                            <span class="text-2xl font-bold text-gray-900">₹15,000 onwards</span>
                            <span class="text-gray-400 text-sm block">per month</span>
                            <button onclick="openEnquiryModal('Payroll')" class="mt-4 w-full bg-white border border-gray-300 text-gray-700 font-semibold py-2 rounded-lg">Enquire Now</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Content: Litigation -->
            <div id="pricing-litigation" class="pricing-content hidden-section animate-fade-in">
                 <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition">
                        <div class="h-12 w-12 bg-yellow-100 rounded-lg flex items-center justify-center text-yellow-600 mb-4"><i class="fa-solid fa-envelope-open-text text-xl"></i></div>
                        <h3 class="text-lg font-bold text-gray-900">Notice Management</h3>
                        <p class="text-sm text-gray-500 mt-2">Expert drafting of responses to Income Tax or GST notices.</p>
                        <div class="mt-6 pt-4 border-t border-gray-100">
                            <span class="text-2xl font-bold text-gray-900">₹2,500 onwards</span>
                            <button onclick="openEnquiryModal('Notice Management')" class="mt-4 w-full bg-white border border-gray-300 text-gray-700 font-semibold py-2 rounded-lg hover:bg-gray-50">Get Assistance</button>
                        </div>
                    </div>
                     <div class="bg-white rounded-xl shadow-md border-2 border-brand-100 p-6 hover:shadow-lg transition relative overflow-hidden">
                        <div class="absolute top-0 right-0 bg-brand-600 text-white text-[10px] font-bold px-3 py-1 rounded-bl-lg">HIGH PRIORITY</div>
                        <div class="h-12 w-12 bg-brand-100 rounded-lg flex items-center justify-center text-brand-600 mb-4"><i class="fa-solid fa-magnifying-glass-chart text-xl"></i></div>
                        <h3 class="text-lg font-bold text-gray-900">Scrutiny Assessment</h3>
                        <p class="text-sm text-gray-500 mt-2">Representation for Section 143(3) proceedings.</p>
                        <div class="mt-6 pt-4 border-t border-gray-100">
                            <span class="text-2xl font-bold text-gray-900">₹15,000 onwards</span>
                            <button onclick="openEnquiryModal('Scrutiny')" class="mt-4 w-full bg-brand-600 text-white font-semibold py-2 rounded-lg hover:bg-brand-700">Consult Expert</button>
                        </div>
                    </div>
                    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition">
                        <div class="h-12 w-12 bg-red-100 rounded-lg flex items-center justify-center text-red-600 mb-4"><i class="fa-solid fa-gavel text-xl"></i></div>
                        <h3 class="text-lg font-bold text-gray-900">Appeals (CIT / GST)</h3>
                        <p class="text-sm text-gray-500 mt-2">Drafting and representation before Commissioner (Appeals).</p>
                        <div class="mt-6 pt-4 border-t border-gray-100">
                            <span class="text-2xl font-bold text-gray-900">₹25,000 onwards</span>
                            <button onclick="openEnquiryModal('Appeals Filing')" class="mt-4 w-full bg-white border border-gray-300 text-gray-700 font-semibold py-2 rounded-lg hover:bg-gray-50">File Appeal</button>
                        </div>
                    </div>
                 </div>
            </div>

            <!-- Content: Advisory -->
            <div id="pricing-advisory" class="pricing-content hidden-section animate-fade-in">
                 <div class="grid grid-cols-1 md:grid-cols-2 gap-8 max-w-5xl mx-auto">
                    <div class="bg-white rounded-xl p-8 border border-gray-200 shadow-sm flex flex-col items-center text-center hover:shadow-lg transition">
                        <div class="h-16 w-16 bg-brand-50 rounded-full flex items-center justify-center text-brand-600 text-2xl mb-6"><i class="fa-solid fa-headset"></i></div>
                        <h3 class="text-lg font-bold text-gray-900 mb-4">On-Call Advisory</h3>
                        <p class="text-gray-600 mb-6 text-sm">Expert opinion on specific tax queries via video/voice call.</p>
                        <button onclick="openEnquiryModal('Advisory')" class="w-full mt-auto bg-brand-600 text-white font-semibold py-2.5 rounded-lg hover:bg-brand-700 transition">Book Slot</button>
                    </div>
                    <div class="bg-white rounded-xl p-8 border border-gray-200 shadow-sm flex flex-col items-center text-center hover:shadow-lg transition">
                        <div class="h-16 w-16 bg-gray-50 rounded-full flex items-center justify-center text-gray-700 text-2xl mb-6"><i class="fa-solid fa-handshake"></i></div>
                        <h3 class="text-lg font-bold text-gray-900 mb-4">Transaction Structuring</h3>
                        <p class="text-gray-600 mb-6 text-sm">Tax planning for mergers, acquisitions, or complex contracts.</p>
                        <button onclick="openEnquiryModal('Structuring')" class="w-full mt-auto bg-gray-800 text-white font-semibold py-2.5 rounded-lg hover:bg-gray-900 transition">Contact Us</button>
                    </div>
                </div>
            </div>
        </main>
    </div>

</div> <!-- End Marketing Site -->

<!-- ============================================ -->
<!-- CLIENT PORTAL APP (Hidden initially)         -->
<!-- ============================================ -->
<div id="client-portal" class="hidden fixed inset-0 z-50 bg-slate-50 flex-col h-full overflow-hidden">
    
    <!-- App Sidebar -->
    <div id="app-sidebar-overlay" class="fixed inset-0 bg-black/50 z-40 hidden" onclick="portalUI.closeSidebar()"></div>
    <aside id="app-sidebar" class="fixed top-0 left-0 h-full w-72 bg-white z-50 shadow-2xl flex flex-col portal-sidebar">
        <div class="p-6 bg-slate-900 text-white flex items-center gap-3">
            <div class="w-10 h-10 rounded-full bg-brand-600 flex items-center justify-center font-bold">VP</div>
            <div>
                <h3 class="font-bold text-sm">Vikram Patel</h3>
                <p class="text-[10px] text-slate-400">client@example.com</p>
            </div>
        </div>
        <nav class="flex-1 overflow-y-auto py-4 space-y-1">
            <button onclick="portalApp.nav('dashboard')" class="w-full text-left px-6 py-3 text-slate-600 hover:bg-brand-50 hover:text-brand-600 flex items-center gap-3"><i class="ph ph-squares-four text-xl"></i> Dashboard</button>
            <button onclick="portalApp.nav('profile')" class="w-full text-left px-6 py-3 text-slate-600 hover:bg-brand-50 hover:text-brand-600 flex items-center gap-3"><i class="ph ph-user-gear text-xl"></i> Business Profile</button>
            <button onclick="portalApp.nav('contact')" class="w-full text-left px-6 py-3 text-slate-600 hover:bg-brand-50 hover:text-brand-600 flex items-center gap-3"><i class="ph ph-address-book text-xl"></i> Contact Info</button>
            <div class="h-px bg-slate-100 my-2"></div>
            <button onclick="portalApp.nav('list', 'ALL')" class="w-full text-left px-6 py-3 text-slate-600 hover:bg-brand-50 hover:text-brand-600 flex items-center gap-3"><i class="ph ph-list-dashes text-xl"></i> All Tasks</button>
            <button onclick="portalApp.nav('list', 'ONGOING')" class="w-full text-left px-6 py-3 text-slate-600 hover:bg-brand-50 hover:text-brand-600 flex items-center gap-3"><i class="ph ph-clock-countdown text-xl"></i> Ongoing</button>
            <button onclick="portalApp.nav('list', 'UPCOMING')" class="w-full text-left px-6 py-3 text-slate-600 hover:bg-brand-50 hover:text-brand-600 flex items-center gap-3"><i class="ph ph-calendar-blank text-xl"></i> Upcoming</button>
            <button onclick="portalApp.nav('list', 'COMPLETED')" class="w-full text-left px-6 py-3 text-slate-600 hover:bg-brand-50 hover:text-brand-600 flex items-center gap-3"><i class="ph ph-check-circle text-xl"></i> History</button>
        </nav>
        <div class="p-4 border-t">
            <button onclick="exitPortal()" class="w-full text-red-500 font-semibold text-sm flex items-center gap-2"><i class="ph ph-sign-out"></i> Logout</button>
        </div>
    </aside>

    <!-- App Header -->
    <header class="bg-white border-b border-gray-200 h-16 flex items-center justify-between px-4 shrink-0">
        <button onclick="portalUI.openSidebar()" class="text-2xl text-slate-600"><i class="ph ph-list"></i></button>
        <h1 id="app-header-title" class="font-bold text-slate-800">Dashboard</h1>
        <div class="w-8"></div>
    </header>

    <!-- App Main Container -->
    <main class="flex-1 overflow-y-auto relative p-4" id="app-main">
        
        <!-- LOGIN SCREEN (FIXED & IMPROVED) -->
        <div id="portal-login" class="fixed inset-0 z-[60] flex flex-col items-center justify-center p-6 portal-page active overflow-hidden">
            <!-- Full Screen Background -->
            <div class="absolute inset-0 z-0 bg-slate-900 overflow-hidden">
                <div class="absolute inset-0 bg-gradient-to-br from-slate-900 via-slate-800 to-brand-900 opacity-90"></div>
                <!-- Abstract Gradient Accents -->
                <div class="absolute top-0 right-0 w-[500px] h-[500px] bg-brand-600 rounded-full mix-blend-multiply filter blur-[128px] opacity-20"></div>
                <div class="absolute bottom-0 left-0 w-[500px] h-[500px] bg-purple-600 rounded-full mix-blend-multiply filter blur-[128px] opacity-20"></div>
                
                <!-- Floating Elements (Updated with negative delay for instant spread) -->
                <div class="float-item text-6xl" style="left: 10%; animation-duration: 15s; animation-delay: -2s;">+</div>
                <div class="float-item text-4xl" style="left: 20%; animation-duration: 18s; animation-delay: -10s;">Tax</div>
                <div class="float-item text-8xl" style="left: 35%; animation-duration: 25s; animation-delay: -5s;">-</div>
                <div class="float-item text-5xl" style="left: 50%; animation-duration: 20s; animation-delay: -15s;">GST</div>
                <div class="float-item text-3xl" style="left: 65%; animation-duration: 16s; animation-delay: -8s;">Return</div>
                <div class="float-item text-7xl" style="left: 80%; animation-duration: 22s; animation-delay: -12s;">+</div>
                <div class="float-item text-5xl" style="left: 90%; animation-duration: 19s; animation-delay: -4s;">Filings</div>
                <div class="float-item text-6xl" style="left: 5%; animation-duration: 24s; animation-delay: -20s;">%</div>
                <div class="float-item text-4xl" style="left: 15%; animation-duration: 21s; animation-delay: -6s;">TDS</div>
                <div class="float-item text-7xl" style="left: 25%; animation-duration: 26s; animation-delay: -18s;">₹</div>
                <div class="float-item text-3xl" style="left: 40%; animation-duration: 17s; animation-delay: -3s;">Audit</div>
                <div class="float-item text-6xl" style="left: 55%; animation-duration: 23s; animation-delay: -14s;">ITR</div>
                <div class="float-item text-5xl" style="left: 70%; animation-duration: 19s; animation-delay: -9s;">PF</div>
                <div class="float-item text-8xl" style="left: 85%; animation-duration: 28s; animation-delay: -22s;">$</div>
            </div>
            
            <!-- Login Card -->
            <div class="relative z-10 w-full max-w-sm bg-white/95 backdrop-blur-xl rounded-3xl shadow-2xl p-8 border border-white/20 animate-fade-in">
                <div class="text-center mb-8">
                    <div class="mx-auto w-16 h-16 bg-brand-50 rounded-2xl flex items-center justify-center text-brand-600 text-3xl mb-4 shadow-sm border border-brand-100 ring-4 ring-brand-50/50">
                        <i class="ph ph-lock-key-open"></i>
                    </div>
                    <h1 class="text-2xl font-bold text-slate-900 tracking-tight" id="authTitle">Welcome Back</h1>
                    <p class="text-slate-500 text-sm mt-1">Sign in to Instant Tax Portal</p>
                </div>

                <div class="space-y-5">
                    <!-- Name Field (Hidden by default) -->
                    <div id="nameFieldContainer" class="hidden">
                         <label class="block text-xs font-bold text-slate-500 uppercase mb-1.5 ml-1">Full Name</label>
                        <div class="relative group">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <i class="ph ph-user text-slate-400 text-lg group-focus-within:text-brand-500 transition-colors"></i>
                            </div>
                            <input id="nameInput" type="text" class="w-full pl-10 pr-4 py-3 rounded-xl border border-slate-200 bg-slate-50 focus:bg-white focus:ring-2 focus:ring-brand-500 focus:border-brand-500 transition-all text-sm font-medium placeholder:text-slate-400" placeholder="John Doe">
                        </div>
                    </div>

                    <div>
                        <label class="block text-xs font-bold text-slate-500 uppercase mb-1.5 ml-1">Email Address</label>
                        <div class="relative group">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <i class="ph ph-envelope-simple text-slate-400 text-lg group-focus-within:text-brand-500 transition-colors"></i>
                            </div>
                            <input id="emailInput" type="email" value="client@example.com" class="w-full pl-10 pr-4 py-3 rounded-xl border border-slate-200 bg-slate-50 focus:bg-white focus:ring-2 focus:ring-brand-500 focus:border-brand-500 transition-all text-sm font-medium placeholder:text-slate-400" placeholder="name@company.com">
                        </div>
                    </div>
                    
                    <div>
                        <div class="flex justify-between items-center mb-1.5 ml-1">
                            <label class="block text-xs font-bold text-slate-500 uppercase">Password</label>
                            <a href="#" onclick="alert('Reset link sent to email.')" class="text-xs font-bold text-brand-600 hover:text-brand-700">Forgot?</a>
                        </div>
                        <div class="relative group">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <i class="ph ph-lock text-slate-400 text-lg group-focus-within:text-brand-500 transition-colors"></i>
                            </div>
                            <input id="passInput" type="password" value="password" class="w-full pl-10 pr-4 py-3 rounded-xl border border-slate-200 bg-slate-50 focus:bg-white focus:ring-2 focus:ring-brand-500 focus:border-brand-500 transition-all text-sm font-medium placeholder:text-slate-400" placeholder="••••••••">
                        </div>
                    </div>

                    <button id="authMainBtn" onclick="portalApp.handleEmailAuth()" class="group w-full bg-slate-900 text-white font-bold py-3.5 rounded-xl shadow-lg hover:bg-black hover:shadow-xl transition-all transform active:scale-95 flex items-center justify-center gap-2">
                        <span>Sign In</span>
                        <i class="ph ph-arrow-right group-hover:translate-x-1 transition-transform"></i>
                    </button>

                    <!-- Google Sign In -->
                    <div class="relative flex py-2 items-center">
                        <div class="flex-grow border-t border-slate-200"></div>
                        <span class="flex-shrink-0 mx-4 text-gray-400 text-xs font-bold">OR</span>
                        <div class="flex-grow border-t border-slate-200"></div>
                    </div>
                    
                    <button onclick="portalApp.loginGoogle()" class="w-full bg-white border border-slate-200 text-slate-600 font-bold py-3 rounded-xl hover:bg-slate-50 transition flex items-center justify-center gap-3">
                        <img src="https://www.svgrepo.com/show/475656/google-color.svg" class="w-5 h-5" alt="Google">
                        Sign in with Google
                    </button>

                     <div class="mt-4 text-center">
                         <span id="authToggleText" class="text-slate-500 text-sm">Don't have an account?</span>
                         <button id="authToggleBtn" onclick="portalApp.toggleAuthMode()" class="text-brand-600 font-bold text-sm hover:underline ml-1">Sign Up</button>
                     </div>
                </div>

                <div class="mt-6 text-center border-t border-slate-200/60 pt-4">
                    <button onclick="exitPortal()" class="text-slate-400 hover:text-brand-600 font-medium text-xs flex items-center justify-center gap-2 mx-auto transition-colors">
                        <i class="ph ph-arrow-left"></i> Return to Website
                    </button>
                </div>
            </div>
            
            <p class="relative z-10 mt-6 text-slate-400 text-xs font-medium">Secured by 256-bit Encryption</p>
        </div>

        <!-- DASHBOARD (Upgraded) -->
        <div id="portal-dashboard" class="portal-page space-y-6">
            <!-- Welcome Card -->
            <div class="bg-slate-900 rounded-2xl p-6 text-white shadow-xl relative overflow-hidden">
                <div class="absolute top-0 right-0 w-32 h-32 bg-brand-600 rounded-full blur-3xl opacity-20 -mr-10 -mt-10"></div>
                <h2 class="text-lg font-medium text-slate-300">Welcome back,</h2>
                <h1 class="text-2xl font-bold mb-4">Vikram Patel</h1>
                <div class="flex gap-4">
                    <div class="bg-white/10 rounded-lg px-4 py-2 backdrop-blur-sm">
                        <span class="block text-2xl font-bold text-orange-400" id="dashOngoing">0</span>
                        <span class="text-[10px] uppercase tracking-wider">Ongoing</span>
                    </div>
                    <div class="bg-white/10 rounded-lg px-4 py-2 backdrop-blur-sm">
                        <span class="block text-2xl font-bold text-brand-400" id="dashUpcoming">0</span>
                        <span class="text-[10px] uppercase tracking-wider">Upcoming</span>
                    </div>
                </div>
            </div>

            <!-- Compliance Analytics (Donut) -->
            <div class="bg-white rounded-xl border border-slate-200 shadow-sm p-4">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="font-bold text-slate-700 text-sm uppercase tracking-wide">Compliance Health</h3>
                    <span class="text-[10px] bg-slate-100 px-2 py-1 rounded text-slate-500 font-medium">FY 2024-25</span>
                </div>
                <div class="flex items-center gap-6">
                    <div class="relative w-24 h-24 flex-shrink-0">
                        <svg class="w-full h-full" viewBox="0 0 100 100">
                            <circle class="text-slate-100 stroke-current" stroke-width="8" cx="50" cy="50" r="40" fill="transparent"></circle>
                            <circle id="healthCircle" class="text-brand-600 progress-ring__circle stroke-current" stroke-width="8" stroke-linecap="round" cx="50" cy="50" r="40" fill="transparent" stroke-dasharray="251.2" stroke-dashoffset="251.2"></circle>
                        </svg>
                        <div class="absolute inset-0 flex flex-col items-center justify-center">
                            <span class="text-lg font-bold text-slate-800" id="healthText">0%</span>
                        </div>
                    </div>
                    <div class="flex-1 space-y-3">
                        <div>
                            <div class="flex justify-between text-[10px] text-slate-500 mb-1"><span>Income Tax</span><span id="statTax">0/0</span></div>
                            <div class="w-full bg-slate-100 rounded-full h-1.5"><div id="barTax" class="bg-green-500 h-1.5 rounded-full" style="width: 0%"></div></div>
                        </div>
                        <div>
                            <div class="flex justify-between text-[10px] text-slate-500 mb-1"><span>GST / Indirect</span><span id="statGst">0/0</span></div>
                            <div class="w-full bg-slate-100 rounded-full h-1.5"><div id="barGst" class="bg-orange-500 h-1.5 rounded-full" style="width: 0%"></div></div>
                        </div>
                    </div>
                </div>
                <!-- Next Deadline -->
                <div class="mt-4 bg-red-50 border border-red-100 rounded-lg p-3 flex items-start gap-3">
                    <div class="bg-white p-1.5 rounded-md shadow-sm text-red-500"><i class="ph ph-calendar-x text-lg"></i></div>
                    <div>
                        <div class="text-[10px] font-bold text-red-500 uppercase">Next Deadline</div>
                        <div class="text-xs font-semibold text-slate-800" id="nextDeadlineText">All Clear</div>
                        <div class="text-[10px] text-slate-500" id="nextDeadlineDate">-</div>
                    </div>
                </div>
            </div>

            <!-- Financial Insights -->
            <div class="bg-white rounded-xl border border-slate-200 shadow-sm p-4">
                <h3 class="font-bold text-slate-700 text-xs uppercase tracking-wide mb-4">Tax Insights</h3>
                <div class="grid grid-cols-2 gap-3 mb-4">
                    <div class="bg-blue-50 rounded-xl p-3 border border-blue-100">
                        <div class="text-[10px] text-blue-500 font-bold uppercase">Total Paid</div>
                        <div class="text-lg font-bold text-slate-800" id="finTotalPaid">₹ 0</div>
                    </div>
                    <div class="bg-purple-50 rounded-xl p-3 border border-purple-100">
                        <div class="text-[10px] text-purple-500 font-bold uppercase">Effective Rate</div>
                        <div class="text-lg font-bold text-slate-800" id="finEffectiveRate">0%</div>
                    </div>
                </div>
                <!-- Simple CSS Chart -->
                <div class="h-24 flex items-end justify-between gap-1 border-b border-slate-100 pb-1">
                    <div class="w-1/6 bg-blue-200 rounded-t-sm" style="height: 30%"></div>
                    <div class="w-1/6 bg-blue-200 rounded-t-sm" style="height: 50%"></div>
                    <div class="w-1/6 bg-blue-200 rounded-t-sm" style="height: 40%"></div>
                    <div class="w-1/6 bg-blue-200 rounded-t-sm" style="height: 70%"></div>
                    <div class="w-1/6 bg-brand-600 rounded-t-sm" style="height: 90%"></div>
                </div>
                <div class="flex justify-between text-[10px] text-slate-400 mt-1">
                    <span>Aug</span><span>Sep</span><span>Oct</span><span>Nov</span><span>Dec</span>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="grid grid-cols-2 gap-3 pb-6">
                <button onclick="portalApp.nav('list', 'ALL')" class="bg-white p-4 rounded-xl border border-slate-200 shadow-sm flex flex-col items-center gap-2 active:scale-95 transition hover:border-brand-500">
                    <div class="w-10 h-10 rounded-full bg-blue-50 text-blue-600 flex items-center justify-center text-xl"><i class="ph ph-list-dashes"></i></div>
                    <span class="text-xs font-bold text-slate-600">All Tasks</span>
                </button>
                <button onclick="portalApp.nav('list', 'ONGOING')" class="bg-white p-4 rounded-xl border border-slate-200 shadow-sm flex flex-col items-center gap-2 active:scale-95 transition hover:border-brand-500">
                    <div class="w-10 h-10 rounded-full bg-orange-50 text-orange-600 flex items-center justify-center text-xl"><i class="ph ph-clock-countdown"></i></div>
                    <span class="text-xs font-bold text-slate-600">Ongoing</span>
                </button>
                <button onclick="portalApp.nav('list', 'UPCOMING')" class="bg-white p-4 rounded-xl border border-slate-200 shadow-sm flex flex-col items-center gap-2 active:scale-95 transition hover:border-brand-500">
                    <div class="w-10 h-10 rounded-full bg-brand-50 text-brand-600 flex items-center justify-center text-xl"><i class="ph ph-calendar-blank"></i></div>
                    <span class="text-xs font-bold text-slate-600">Upcoming</span>
                </button>
                <button onclick="portalApp.nav('list', 'COMPLETED')" class="bg-white p-4 rounded-xl border border-slate-200 shadow-sm flex flex-col items-center gap-2 active:scale-95 transition hover:border-brand-500">
                    <div class="w-10 h-10 rounded-full bg-green-50 text-green-600 flex items-center justify-center text-xl"><i class="ph ph-archive"></i></div>
                    <span class="text-xs font-bold text-slate-600">History</span>
                </button>
            </div>
        </div>

        <!-- LIST PAGE -->
        <div id="portal-list" class="portal-page p-4">
            <div id="appListContainer" class="space-y-3 pb-20"></div>
        </div>

        <!-- PROFILE PAGE (Detailed) -->
        <div id="portal-profile" class="portal-page p-4">
            <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm space-y-4">
                <h3 class="font-bold text-slate-800 border-b pb-2">Business Configuration</h3>
                <div>
                    <label class="text-xs font-bold text-slate-500 uppercase">Entity Type</label>
                    <select id="profType" class="w-full mt-1 p-3 bg-slate-50 rounded-lg border border-slate-200 text-sm font-medium">
                        <option value="Private Limited">Private Limited Co.</option>
                        <option value="LLP">LLP</option>
                        <option value="Individual">Individual</option>
                    </select>
                </div>
                <div>
                    <label class="text-xs font-bold text-slate-500 uppercase">Annual Turnover</label>
                    <select id="profTurnover" class="w-full mt-1 p-3 bg-slate-50 rounded-lg border border-slate-200 text-sm font-medium">
                        <option value="1500000">< 20 Lakhs</option>
                        <option value="50000000">> 1.5 Crores</option>
                        <option value="150000000">> 10 Crores</option>
                    </select>
                </div>
                <div class="flex items-center justify-between py-2">
                    <span class="text-sm font-medium text-slate-700">GST Registration?</span>
                    <input type="checkbox" id="profGst" class="w-5 h-5 accent-brand-600" checked>
                </div>
                <div class="flex items-center justify-between py-2">
                    <span class="text-sm font-medium text-slate-700">Payroll (Employees)?</span>
                    <input type="checkbox" id="profPayroll" class="w-5 h-5 accent-brand-600">
                </div>
                <button onclick="portalApp.saveProfile()" class="w-full bg-brand-600 text-white font-bold py-3 rounded-xl mt-4 shadow-lg hover:bg-brand-700 active:scale-95 transition">
                    Save & Generate List
                </button>
            </div>
        </div>

        <!-- NEW: CONTACT INFO PAGE -->
        <div id="portal-contact" class="portal-page p-4">
            <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm space-y-4">
                <h3 class="font-bold text-slate-800 border-b pb-2">Contact Information</h3>
                <div>
                    <label class="text-xs font-bold text-slate-500 uppercase">Contact Person</label>
                    <input type="text" value="Vikram Patel" class="w-full mt-1 p-3 bg-slate-50 rounded-lg border border-slate-200 text-sm font-medium">
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="text-xs font-bold text-slate-500 uppercase">Phone Number</label>
                        <input type="tel" value="+91 98765 43210" class="w-full mt-1 p-3 bg-slate-50 rounded-lg border border-slate-200 text-sm font-medium">
                    </div>
                    <div>
                        <label class="text-xs font-bold text-slate-500 uppercase">Email Address</label>
                        <input type="email" value="vikram@client.com" class="w-full mt-1 p-3 bg-slate-50 rounded-lg border border-slate-200 text-sm font-medium">
                    </div>
                </div>
                <div>
                    <label class="text-xs font-bold text-slate-500 uppercase">Registered Address</label>
                    <textarea class="w-full mt-1 p-3 bg-slate-50 rounded-lg border border-slate-200 text-sm font-medium" rows="3">123, Tech Park, Financial District, Hyderabad, Telangana - 500032</textarea>
                </div>
                <button onclick="portalApp.saveContact()" class="w-full bg-slate-800 text-white font-bold py-3 rounded-xl mt-4 shadow-lg hover:bg-slate-900 active:scale-95 transition">
                    Update Contact Details
                </button>
            </div>
        </div>

        <!-- WORKSPACE PAGE -->
        <div id="portal-workspace" class="portal-page h-full flex flex-col">
            <div class="flex-1 bg-slate-100 rounded-xl p-4 mb-4 overflow-y-auto" id="appChatContainer"></div>
            <div class="flex gap-2">
                <input type="text" placeholder="Type message..." class="flex-1 rounded-full border-gray-300 shadow-sm px-4">
                <button class="bg-brand-600 text-white rounded-full w-10 h-10 flex items-center justify-center"><i class="ph ph-paper-plane-right"></i></button>
            </div>
        </div>
    </main>
</div>

<!-- PAYMENT MODAL (App) -->
<div id="paymentModal" class="fixed inset-0 z-[70] hidden flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm">
    <div class="bg-white w-full max-w-sm rounded-2xl p-6 text-center shadow-2xl">
        <div class="w-16 h-16 bg-brand-100 text-brand-600 rounded-full flex items-center justify-center text-3xl mx-auto mb-4"><i class="ph ph-lock-key"></i></div>
        <h2 class="text-xl font-bold text-slate-900">Service Locked</h2>
        <p class="text-sm text-slate-500 mt-2 mb-6">Complete payment for <span id="payItemName" class="font-bold text-slate-800"></span>.</p>
        <div class="bg-slate-50 rounded-lg p-4 mb-6 border border-slate-100">
            <div class="flex justify-between text-base font-bold text-brand-600"><span>Total</span><span>₹ 1,770</span></div>
        </div>
        <div class="flex gap-3">
            <button onclick="portalUI.closePayment()" class="flex-1 py-3 text-sm font-bold text-slate-500 bg-slate-100 rounded-xl">Cancel</button>
            <button onclick="portalApp.processPayment()" class="flex-1 py-3 text-sm font-bold text-white bg-brand-600 rounded-xl shadow-lg">Pay Now</button>
        </div>
    </div>
</div>

<!-- ENQUIRY MODAL (Marketing) -->
<div id="enquiryModal" class="fixed inset-0 z-[70] hidden flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm">
    <div class="bg-white rounded-2xl p-6 max-w-sm w-full shadow-2xl">
        <div class="text-center mb-4">
            <h3 class="font-bold text-lg">Contact Us</h3>
            <p class="text-sm text-gray-500">regarding <span id="enquiryServiceName" class="font-bold"></span></p>
        </div>
        <button onclick="document.getElementById('enquiryModal').classList.add('hidden')" class="w-full py-2 border border-gray-300 rounded-lg text-sm font-bold">Close</button>
    </div>
</div>

<!-- ======================= LOGIC SCRIPTS ======================= -->
<script>
    // Config
    const firebaseConfig = {
      apiKey: "AIzaSyD_sy5MyGBvNaAKalljRcpKwTuC4zGXZGU",
      authDomain: "instant-tax-india.firebaseapp.com",
      databaseURL: "https://instant-tax-india-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "instant-tax-india",
      storageBucket: "instant-tax-india.firebasestorage.app",
      messagingSenderId: "754581902954",
      appId: "1:754581902954:web:b03e3965588545baaedc13",
      measurementId: "G-MMN0WR7D08"
    };

    // --- 1. MARKETING ROUTER ---
    function router(view) {
        document.querySelectorAll('.view-section').forEach(el => el.classList.add('hidden-section'));
        document.getElementById(`view-${view}`).classList.remove('hidden-section');
        window.scrollTo(0,0);
        document.getElementById('mobile-menu').classList.add('hidden');
        
        if(view === 'checklist' && window.app) {
            window.app.loadState();
            window.app.updateFields();
            if(window.app.hasRun) window.app.render();
        }
    }

    function toggleMobileMenu() {
        document.getElementById('mobile-menu').classList.toggle('hidden');
    }

    // --- 2. SWITCHING LOGIC ---
    function startPortal() {
        document.getElementById('marketing-site').classList.add('hidden');
        document.getElementById('client-portal').classList.remove('hidden');
        document.getElementById('client-portal').classList.add('flex');
        portalApp.nav('login');
    }

    function exitPortal() {
        document.getElementById('client-portal').classList.add('hidden');
        document.getElementById('client-portal').classList.remove('flex');
        document.getElementById('marketing-site').classList.remove('hidden');
        router('home');
    }

    // --- 3. PORTAL APP LOGIC (ROBUST VERSION) ---
    const portalMasterData = [
        { id: "GSTR1", cat: "INDIRECT", title: "GST Sales (R1)", form: "GSTR-1", freq: "Monthly", date: "11th", logic: { gst: true }, day: 11 },
        { id: "PF", cat: "LABOUR", title: "PF Contribution", form: "ECR", freq: "Monthly", date: "15th", logic: { payroll: true }, day: 15 },
        { id: "GSTR3B", cat: "INDIRECT", title: "GST Return (3B)", form: "GSTR-3B", freq: "Monthly", date: "20th", logic: { gst: true }, day: 20 },
        { id: "ADV", cat: "TAX", title: "Advance Tax Q4", form: "Challan", freq: "Quarterly", date: "15th Mar", logic: { type: "ALL" }, day: 75 },
        { id: "ITR", cat: "TAX", title: "Income Tax Filing", form: "ITR", freq: "Annual", date: "31st July", logic: { type: "ALL" }, day: 210 },
        { id: "ROC", cat: "CORP", title: "Annual Filing", form: "AOC-4", freq: "Annual", date: "30th Oct", logic: { type: ["Private Limited"] }, day: 300 }
    ];

    const portalApp = {
        currentFilter: 'ALL',
        isSignup: false,
        profile: { type: "Private Limited", turnover: 150000000, gst: true, payroll: false },
        statusMap: {
            "GSTR3B": { status: "ONGOING", paid: false, dueDate: "20th Jan" },
            "GSTR1": { status: "COMPLETED", paid: true, dueDate: "11th Jan", completedDate: "10th Jan" },
            "ADV": { status: "UPCOMING", paid: false, dueDate: "15th Mar" },
            "ITR": { status: "UPCOMING", paid: false, dueDate: "31st July" }
        },

        nav(pageId, filter) {
            document.querySelectorAll('.portal-page').forEach(el => el.classList.remove('active'));
            document.getElementById(`portal-${pageId}`).classList.add('active');
            
            const titles = { 'dashboard': 'Dashboard', 'profile': 'Profile', 'contact': 'Contact Info', 'list': 'Compliances', 'login': 'Login' };
            const titleEl = document.getElementById('app-header-title');
            if(titleEl) titleEl.innerText = titles[pageId] || 'Portal';
            
            portalUI.closeSidebar();
            if(pageId === 'list') this.renderList(filter);
            if(pageId === 'dashboard') this.updateDashboardStats();
        },
        
        toggleAuthMode() {
            this.isSignup = !this.isSignup;
            const nameField = document.getElementById('nameFieldContainer');
            const title = document.getElementById('authTitle');
            const btn = document.getElementById('authMainBtn');
            const toggleText = document.getElementById('authToggleText');
            const toggleBtn = document.getElementById('authToggleBtn');

            if(this.isSignup) {
                nameField.classList.remove('hidden');
                title.innerText = "Create Account";
                btn.innerHTML = "<span>Sign Up</span><i class='ph ph-arrow-right group-hover:translate-x-1 transition-transform'></i>";
                toggleText.innerText = "Already have an account?";
                toggleBtn.innerText = "Sign In";
            } else {
                nameField.classList.add('hidden');
                title.innerText = "Welcome Back";
                btn.innerHTML = "<span>Sign In</span><i class='ph ph-arrow-right group-hover:translate-x-1 transition-transform'></i>";
                toggleText.innerText = "Don't have an account?";
                toggleBtn.innerText = "Sign Up";
            }
        },

        handleEmailAuth() {
            const email = document.getElementById('emailInput').value;
            const pass = document.getElementById('passInput').value;
            
            if(this.isSignup) {
                // Sign Up Logic
                firebase.auth().createUserWithEmailAndPassword(email, pass)
                .then((userCredential) => {
                    const name = document.getElementById('nameInput').value;
                    // Mock Profile save
                    alert("Account Created! Welcome " + name);
                    this.login();
                })
                .catch((error) => {
                    alert("Error: " + error.message);
                });
            } else {
                // Login Logic
                firebase.auth().signInWithEmailAndPassword(email, pass)
                .then((userCredential) => {
                    this.login();
                })
                .catch((error) => {
                    // Fallback for demo if firebase fails or no net
                    if(email === 'client@example.com') this.login();
                    else alert("Error: " + error.message);
                });
            }
        },

        loginGoogle() {
            var provider = new firebase.auth.GoogleAuthProvider();
            firebase.auth().signInWithPopup(provider).then((result) => {
                this.login();
            }).catch((error) => {
                console.log(error);
                alert("Google Sign In Failed (Check Console)");
            });
        },

        login() {
            document.getElementById('portal-login').classList.remove('active');
            this.refreshList();
            this.nav('dashboard');
        },

        saveProfile() {
            this.profile.type = document.getElementById('profType').value;
            this.profile.turnover = parseInt(document.getElementById('profTurnover').value);
            this.profile.gst = document.getElementById('profGst').checked;
            this.profile.payroll = document.getElementById('profPayroll').checked;
            alert("Profile Updated! Recalculating...");
            this.refreshList();
            this.nav('dashboard');
        },

        saveContact() {
            alert("Contact Information Updated Successfully!");
        },

        getApplicable() {
            return portalMasterData.filter(item => {
                const l = item.logic;
                if (l.type && l.type !== "ALL") { if (Array.isArray(l.type) && !l.type.includes(this.profile.type)) return false; }
                if (l.gst && !this.profile.gst) return false;
                if (l.payroll && !this.profile.payroll) return false;
                return true;
            });
        },

        refreshList() {
            const applicable = this.getApplicable();
            applicable.forEach(item => {
                if(!this.statusMap[item.id]) {
                    this.statusMap[item.id] = { status: "UPCOMING", paid: false, dueDate: item.date };
                }
            });
            this.updateDashboardStats();
        },

        updateDashboardStats() {
            const applicable = this.getApplicable();
            let ongoing = 0, upcoming = 0, completed = 0;
            let catCounts = { 'TAX': {total:0, done:0}, 'INDIRECT': {total:0, done:0}, 'CORP': {total:0, done:0}, 'LABOUR': {total:0, done:0} };
            
            applicable.forEach(item => {
                const s = this.statusMap[item.id].status;
                if(s === 'ONGOING') ongoing++;
                if(s === 'UPCOMING') upcoming++;
                if(s === 'COMPLETED') completed++;
                const cat = item.cat;
                if(catCounts[cat]) { catCounts[cat].total++; if(s==='COMPLETED') catCounts[cat].done++; }
            });

            document.getElementById('dashOngoing').innerText = ongoing;
            document.getElementById('dashUpcoming').innerText = upcoming;

            const total = applicable.length;
            const percentage = total === 0 ? 0 : Math.round((completed / total) * 100);
            const circle = document.getElementById('healthCircle');
            if(circle) {
                const radius = circle.r.baseVal.value;
                const circumference = radius * 2 * Math.PI;
                const offset = circumference - (percentage / 100) * circumference;
                circle.style.strokeDashoffset = offset;
            }
            document.getElementById('healthText').innerText = `${percentage}%`;

            const updateBar = (k, tId, bId) => {
                const d = catCounts[k];
                const p = d.total === 0 ? 0 : Math.round((d.done/d.total)*100);
                document.getElementById(tId).innerText = `${d.done}/${d.total}`;
                document.getElementById(bId).style.width = `${p}%`;
            };
            updateBar('TAX','statTax','barTax');
            updateBar('INDIRECT','statGst','barGst');

            const t = this.profile.turnover;
            let rate = t > 100000000 ? 25 : 15;
            let tax = (t * (rate/100)) / 100000;
            document.getElementById('finTotalPaid').innerText = `₹ ${tax.toFixed(1)} L`;
            document.getElementById('finEffectiveRate').innerText = `${rate}%`;
            
            const pending = applicable.filter(i => this.statusMap[i.id].status !== 'COMPLETED').sort((a,b) => (a.day||999) - (b.day||999));
            if(pending.length > 0) {
                document.getElementById('nextDeadlineText').innerText = pending[0].title;
                document.getElementById('nextDeadlineDate').innerText = "Due: " + pending[0].date;
            } else {
                document.getElementById('nextDeadlineText').innerText = "All Clear";
            }
        },

        renderList(filter) {
            const container = document.getElementById('appListContainer');
            if(!container) return;
            container.innerHTML = '';
            
            const applicable = this.getApplicable();
            let hasItems = false;

            applicable.forEach(item => {
                const state = this.statusMap[item.id];
                if(filter !== 'ALL' && state.status !== filter) return;
                hasItems = true;

                let badgeColor = state.status === 'ONGOING' ? 'text-orange-600 bg-orange-50' : 
                                 (state.status === 'COMPLETED' ? 'text-green-600 bg-green-50' : 'text-slate-600 bg-slate-50');
                
                let action = '';
                if(state.status === 'ONGOING') {
                    action = `<button onclick="portalApp.openWorkspace('${item.id}', '${item.title}')" class="mt-3 w-full bg-slate-50 text-brand-600 font-bold text-xs py-2 rounded border border-slate-200">
                                ${state.paid ? 'Open Workspace' : 'Pay to Unlock'}
                              </button>`;
                } else if(state.status === 'UPCOMING') {
                    action = `<button onclick="portalApp.moveStatus('${item.id}', 'ONGOING')" class="mt-3 w-full bg-brand-50 text-brand-600 font-bold text-xs py-2 rounded">Start Now</button>`;
                }

                container.innerHTML += `
                <div class="bg-white p-4 rounded-xl border border-slate-200 shadow-sm mb-3">
                    <div class="flex justify-between items-start">
                        <div>
                            <h4 class="font-bold text-slate-800 text-sm">${item.title}</h4>
                            <p class="text-xs text-slate-500">Due: ${item.date}</p>
                        </div>
                        <span class="text-[10px] font-bold px-2 py-1 rounded ${badgeColor}">${state.status}</span>
                    </div>
                    ${action}
                </div>`;
            });
            
            if(!hasItems) container.innerHTML = `<div class="text-center text-gray-400 py-10">No items found.</div>`;
        },

        moveStatus(id, status) {
            this.statusMap[id].status = status;
            this.refreshList();
            this.renderList(this.currentFilter);
        },

        openWorkspace(id, title) {
            if(this.statusMap[id].paid) {
                this.nav('workspace');
                document.getElementById('app-header-title').innerText = title;
                document.getElementById('appChatContainer').innerHTML = `
                    <div class="text-center text-xs text-gray-400 my-4">Workspace Created</div>
                    <div class="bg-white p-3 rounded-lg rounded-tl-none shadow-sm text-sm w-3/4 mb-2">
                        <span class="text-brand-600 font-bold block text-xs">CA Team</span>
                        Please upload documents for ${title}.
                    </div>
                `;
            } else {
                portalUI.openPayment(id, title);
            }
        },

        processPayment() {
            const id = portalUI.pendingPaymentId;
            const btn = document.querySelector('#paymentModal button.bg-brand-600');
            btn.innerHTML = 'Processing...';
            setTimeout(() => {
                this.statusMap[id].paid = true;
                portalUI.closePayment();
                btn.innerHTML = 'Pay Now';
                alert('Payment Successful!');
                this.openWorkspace(id, document.getElementById('payItemName').innerText);
            }, 1000);
        }
    };

    const portalUI = {
        pendingPaymentId: null,
        openSidebar() { document.getElementById('app-sidebar').classList.add('active'); document.getElementById('app-sidebar-overlay').classList.remove('hidden'); },
        closeSidebar() { document.getElementById('app-sidebar').classList.remove('active'); document.getElementById('app-sidebar-overlay').classList.add('hidden'); },
        openPayment(id, title) {
            this.pendingPaymentId = id;
            document.getElementById('payItemName').innerText = title;
            document.getElementById('paymentModal').classList.remove('hidden');
        },
        closePayment() {
            document.getElementById('paymentModal').classList.add('hidden');
        }
    };

    // --- 4. CHECKLIST APP LOGIC (Restored) ---
    // Full Data Array from user request
    const complianceData = [
        // 1. NEW INCORPORATION
        { cat: "CORP", title: "First Auditor Appt", form: "ADT-1", freq: "One-Time", date: "30 Days Inc", act: "Companies Act, 2013", desc: "Appointment of First Auditor by Board.", penalty: "Fine.", logic: { type: ["Private Limited", "Public Limited", "Listed", "Section 8"], newInc: true } },
        { cat: "CORP", title: "Commencement of Biz", form: "INC-20A", freq: "One-Time", date: "180 Days Inc", act: "Companies Act, 2013", desc: "Declaration that subcribers have paid capital.", penalty: "₹50k + ₹1000/day.", logic: { type: ["Private Limited", "Public Limited"], newInc: true } },
        // 2. DIRECTORS & GOVERNANCE
        { cat: "DIR_COMM", title: "Min. Directors (Pvt)", form: "Sec 149", freq: "Continuous", date: "N/A", act: "Companies Act, 2013", desc: "Private Companies must maintain a minimum of 2 directors.", penalty: "Penalty on company/officer.", logic: { type: ["Private Limited", "Section 8"] } },
        { cat: "DIR_COMM", title: "Min. Directors (Public)", form: "Sec 149", freq: "Continuous", date: "N/A", act: "Companies Act, 2013", desc: "Public Companies must maintain a minimum of 3 directors.", penalty: "Penalty on company/officer.", logic: { type: ["Public Limited", "Listed"] } },
        { cat: "DIR_COMM", title: "Resident Director", form: "Sec 149(3)", freq: "Annual", date: "Continuous", act: "Companies Act, 2013", desc: "One director must stay in India for ≥ 182 days.", penalty: "Fine ₹50k - ₹5L.", logic: { type: ["Private Limited", "Public Limited", "Listed", "Section 8"] } },
        { cat: "DIR_COMM", title: "Disclosure of Interest", form: "MBP-1", freq: "Annual", date: "1st Board Meeting", act: "Companies Act, 2013", desc: "Disclosure of interest in other entities (Sec 184).", penalty: "Vacation of office; Fine up to ₹1L.", logic: { type: ["Private Limited", "Public Limited", "Listed", "Section 8"] } },
        { cat: "DIR_COMM", title: "Non-Disqualification", form: "DIR-8", freq: "Annual", date: "1st Board Meeting", act: "Companies Act, 2013", desc: "Declaration that director is not disqualified u/s 164(2).", penalty: "Disqualification.", logic: { type: ["Private Limited", "Public Limited", "Listed", "Section 8"] } },
        { cat: "DIR_COMM", title: "DIR-3 KYC (Personal)", form: "DIR-3", freq: "Annual", date: "30th Sept", act: "Companies Act, 2013", desc: "Personal KYC for Directors (DIN holders).", penalty: "DIN Deactivation + ₹5000.", logic: { type: ["Individual"], director: true } },
        // --- 2. DIRECT TAX ---
        { cat: "TAX", title: "Option: Presumptive Tax (44AD)", form: "ITR-4", freq: "Annual", date: "15th Mar", act: "Income Tax Act", desc: "Business Turnover < 2Cr. Declare 8%/6% profit. No Audit.", penalty: "Interest.", logic: { type: ["Individual", "LLP", "Partnership"], maxTurnover: 20000000, scheme: true, indivType: "Business" } },
        { cat: "TAX", title: "Option: Presumptive Prof (44ADA)", form: "ITR-4", freq: "Annual", date: "15th Mar", act: "Income Tax Act", desc: "Receipts < 75L. Declare 50% profit. No Audit.", penalty: "Interest.", logic: { type: ["Individual", "Partnership"], maxTurnover: 7500000, scheme: true, indivType: "Professional" } },
        { cat: "TAX", title: "Advance Tax Payments", form: "Challan 280", freq: "Quarterly", date: "15th Jun/Sep/Dec/Mar", act: "Income Tax Act", desc: "Pay 15/45/75/100% of estimated tax.", penalty: "Interest 1% p.m.", logic: { type: "ALL" } },
        { cat: "TAX", title: "Monthly TDS Payment", form: "Challan 281", freq: "Monthly", date: "7th of Next Month", act: "Income Tax Act", desc: "Deposit of Tax Deducted at Source.", penalty: "Interest 1.5% p.m.", logic: { type: "ALL", tds: true } },
        { cat: "TAX", title: "TDS Returns", form: "24Q/26Q", freq: "Quarterly", date: "31st Jul/Oct/Jan/May", act: "Income Tax Act", desc: "Quarterly statement of tax deducted.", penalty: "₹200/day.", logic: { type: "ALL", tds: true } },
        { cat: "TAX", title: "ITR Filing (Audit)", form: "ITR-3/5/6", freq: "Annual", date: "31st Oct", act: "Income Tax Act", desc: "Return for Audited Cases.", penalty: "Late fee.", logic: { type: ["Private Limited", "Public Limited", "Listed", "LLP", "Foreign Co", "Trust", "Section 8"] } },
        { cat: "TAX", title: "ITR Filing (Non-Audit)", form: "ITR-3/4/5", freq: "Annual", date: "31st July", act: "Income Tax Act", desc: "Return for Non-Audit cases.", penalty: "Late fee.", logic: { type: ["Individual", "Partnership"] } },
        { cat: "TAX", title: "Tax Audit Report", form: "3CA/3CD", freq: "Annual", date: "30th Sept", act: "Income Tax Act", desc: "Mandatory if T/O > ₹1Cr (₹10Cr Digital).", penalty: "0.5% of turnover.", logic: { minTurnover: 10000000 } },
        // --- 3. INDIRECT TAX ---
        { cat: "INDIRECT", title: "GSTR-1/3B (Monthly)", form: "GSTR-1/3B", freq: "Monthly", date: "11th & 20th", act: "GST Act", desc: "Turnover > ₹5 Cr. Sales & Payment.", penalty: "Late fee + Interest.", logic: { gst: true, minTurnover: 50000001 } },
        { cat: "INDIRECT", title: "GSTR-1/3B (QRMP)", form: "GSTR-1/3B", freq: "Quarterly", date: "13th & 22nd", act: "GST Act", desc: "Turnover < ₹5 Cr. Quarterly Filing.", penalty: "Late fee.", logic: { gst: true, maxTurnover: 50000000 } },
        { cat: "INDIRECT", title: "GST Annual Return", form: "GSTR-9/9C", freq: "Annual", date: "31st Dec", act: "GST Act", desc: "Consolidated Return.", penalty: "Late fee.", logic: { gst: true, minTurnover: 20000000 } },
        // --- 4. COMPANIES ACT ---
        { cat: "CORP", title: "Financials", form: "AOC-4", freq: "Annual", date: "30 days AGM", act: "Companies Act", desc: "Balance Sheet & P&L.", penalty: "₹100/day.", logic: { type: ["Private Limited", "Public Limited", "Listed", "Section 8"] } },
        { cat: "CORP", title: "Annual Return", form: "MGT-7", freq: "Annual", date: "60 days AGM", act: "Companies Act", desc: "Detailed Return.", penalty: "₹100/day.", logic: { type: ["Private Limited", "Public Limited", "Listed", "Section 8"] } },
        // --- 5. PAYROLL ---
        { cat: "LABOUR", title: "PF/ESI Payment", form: "Challan", freq: "Monthly", date: "15th", act: "EPF/ESI Act", desc: "Contribution payment.", penalty: "Damages.", logic: { payroll: true } },
        // --- 6. FEMA & OTHERS ---
        { cat: "FEMA", title: "FLA Return", form: "FLA", freq: "Annual", date: "15th July", act: "FEMA", desc: "Foreign Liabilities & Assets.", penalty: "3x Amount.", logic: { hasFDI: true, type: ["Private Limited", "Public Limited", "LLP", "Listed"] } },
        { cat: "FEMA", title: "ECB Return", form: "ECB-2", freq: "Monthly", date: "7th", act: "FEMA", desc: "External Commercial Borrowings.", penalty: "Penalty.", logic: { hasFDI: true, highDebt: true } },
        { cat: "FEMA", title: "FC-GPR", form: "FC-GPR", freq: "Event", date: "30 Days", act: "FEMA", desc: "Reporting of FDI inflow/allotment.", penalty: "Compounding.", logic: { hasFDI: true } },
        { cat: "FEMA", title: "FC-TRS", form: "FC-TRS", freq: "Event", date: "60 Days", act: "FEMA", desc: "Transfer of shares between Resident & Non-Resident.", penalty: "Compounding.", logic: { hasFDI: true } },
        
        // --- 7. SEBI (LISTED) ---
        { cat: "SEBI", title: "Quarterly Financials", form: "Reg 33", freq: "Quarterly", date: "45 Days", act: "SEBI LODR", desc: "Financial Results publication.", penalty: "Suspension.", logic: { type: ["Listed"] } },
        { cat: "SEBI", title: "Shareholding Pattern", form: "Reg 31", freq: "Quarterly", date: "21 Days", act: "SEBI LODR", desc: "Disclosure of shareholding.", penalty: "Fine.", logic: { type: ["Listed"] } },
        { cat: "SEBI", title: "Corporate Governance", form: "Reg 27", freq: "Quarterly", date: "15 Days", act: "SEBI LODR", desc: "Corporate Governance Report.", penalty: "Fine.", logic: { type: ["Listed"] } },
        { cat: "SEBI", title: "Reconciliation Audit", form: "Reg 76", freq: "Quarterly", date: "30 Days", act: "DP Regs", desc: "Share Capital Audit.", penalty: "Fine.", logic: { type: ["Listed"] } },
        { cat: "SEBI", title: "Trading Window", form: "Closure", freq: "Quarterly", date: "Qtr End", act: "SEBI PIT", desc: "Intimation of window closure.", penalty: "Fine.", logic: { type: ["Listed"] } },
        
        // --- 8. OTHERS ---
        { cat: "CORP", title: "Trust Renewal", form: "10A/10AB", freq: "5 Years", date: "Variable", act: "Income Tax", desc: "Renewal of 12A/80G Registration.", penalty: "Exemption Lost.", logic: { type: ["Trust", "Section 8"] } }
    ];

    window.app = {
        activeCat: 'DASHBOARD',
        hasRun: false,
        STORAGE_KEY: 'ITS_ComplianceMaster_State',
        
        loadState() {
             // Basic state loading logic
        },
        
        updateFields() {
             // Basic field update logic
        },

        resetAll() {
            this.hasRun = false;
            document.getElementById('initialInstruction').classList.remove('hidden');
            document.getElementById('dashboardSection').classList.add('hidden');
            document.getElementById('listSection').classList.add('hidden');
            document.getElementById('tabsWrapper').classList.add('hidden');
        },

        manualRun() {
            this.hasRun = true;
            this.render();
        },

        toggleSidebar() {
            document.getElementById('configSidebar').classList.toggle('-translate-x-full');
        },

        setCat(c) {
            this.activeCat = c;
            this.render();
        },

        render() {
            const container = document.getElementById('complianceBody');
            if(container) {
                const type = document.getElementById('entityType').value;
                const hasGST = document.getElementById('hasGST').checked;
                
                // Detailed filtering
                const filtered = complianceData.filter(i => {
                     const l = i.logic;
                     if(l.type && l.type !== "ALL") {
                         if(Array.isArray(l.type) && !l.type.includes(type)) return false;
                     }
                     if(l.gst && !hasGST) return false;
                     return true;
                });

                // Tab counts
                const globalCounts = {};
                filtered.forEach(i => globalCounts[i.cat] = (globalCounts[i.cat] || 0) + 1);
                
                // Render Tabs
                const tabsContainer = document.getElementById('tabsContainer');
                const tabs = [{k:'DASHBOARD', n:'Dashboard'}, {k:'ALL', n:'All List'}, 
                              {k:'TAX', n:'Tax'}, {k:'INDIRECT', n:'GST'}, {k:'CORP', n:'Corporate'}, {k:'LABOUR', n:'Payroll'}];
                
                if(tabsContainer) {
                    tabsContainer.innerHTML = tabs.map(t => {
                        const count = (t.k === 'ALL' || t.k === 'DASHBOARD') ? filtered.length : (globalCounts[t.k] || 0);
                        if(count === 0 && t.k !== 'DASHBOARD' && t.k !== 'ALL') return '';
                        
                        const isActive = this.activeCat === t.k;
                        let colorClass = isActive ? "border-brand-600 text-brand-700 bg-brand-50" : "border-transparent text-slate-600";
                        return `<button onclick="window.app.setCat('${t.k}')" class="px-4 py-2 border-b-2 text-sm font-medium ${colorClass}">${t.n} <span class="bg-slate-200 text-xs px-1 rounded">${count}</span></button>`;
                    }).join('');
                }

                // Render Content
                if (this.activeCat === 'DASHBOARD') {
                     document.getElementById('dashboardSection').classList.remove('hidden');
                     document.getElementById('listSection').classList.add('hidden');
                     // Update stats
                     document.getElementById('totalCount').innerText = filtered.length;
                     
                     // 1. Chart Logic
                     const ctx = document.getElementById('complianceChart');
                     if(ctx) {
                        if(window.myChart) window.myChart.destroy();
                        
                        const dataMap = { 'TAX': 0, 'INDIRECT': 0, 'CORP': 0, 'LABOUR': 0 };
                        filtered.forEach(i => { if(dataMap[i.cat] !== undefined) dataMap[i.cat]++; });
                        
                        window.myChart = new Chart(ctx, {
                             type: 'doughnut',
                             data: {
                                 labels: ['Direct Tax', 'GST', 'Corporate', 'Payroll'],
                                 datasets: [{ 
                                     data: [dataMap['TAX'], dataMap['INDIRECT'], dataMap['CORP'], dataMap['LABOUR']], 
                                     backgroundColor: ['#16a34a', '#ea580c', '#7c3aed', '#db2777'],
                                     borderWidth: 0
                                 }]
                             },
                             options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, cutout: '75%' }
                         });
                     }

                     // 2. Populate Category Grid (Large Cards)
                     const grid = document.getElementById('categoryGrid');
                     if(grid) {
                        const cats = {
                            'TAX': { l: 'Direct Tax', c: 'text-green-600 bg-green-50' },
                            'INDIRECT': { l: 'GST & Customs', c: 'text-orange-600 bg-orange-50' },
                            'CORP': { l: 'Corporate Law', c: 'text-violet-600 bg-violet-50' },
                            'LABOUR': { l: 'Payroll', c: 'text-pink-600 bg-pink-50' }
                        };
                        grid.innerHTML = Object.keys(cats).map(k => {
                            if(!globalCounts[k]) return '';
                            return `<div onclick="window.app.setCat('${k}')" class="bg-white p-4 rounded-xl border border-slate-100 shadow-card hover:shadow-card-hover transition-all cursor-pointer flex items-center justify-between group">
                                <div>
                                    <div class="text-[10px] font-bold uppercase tracking-wider text-slate-400 mb-1">${cats[k].l}</div>
                                    <div class="text-2xl font-bold text-slate-800">${globalCounts[k]}</div>
                                </div>
                                <div class="w-10 h-10 rounded-full flex items-center justify-center ${cats[k].c}"><i class="ph ph-arrow-right font-bold"></i></div>
                            </div>`;
                        }).join('');
                     }

                     // 3. Populate Summary List (Below Chart)
                     const summary = document.getElementById('chartSummary');
                     if(summary) {
                         summary.innerHTML = Object.keys(globalCounts).map(k => 
                            `<div class="flex justify-between items-center"><span class="font-semibold text-slate-600">${k}</span><span class="font-bold text-slate-800">${globalCounts[k]}</span></div>`
                         ).join('');
                     }

                } else {
                     document.getElementById('dashboardSection').classList.add('hidden');
                     document.getElementById('listSection').classList.remove('hidden');
                     
                     const displayList = this.activeCat === 'ALL' ? filtered : filtered.filter(i => i.cat === this.activeCat);
                     
                     container.innerHTML = displayList.map(i => `
                        <div onclick="window.app.openModal(${complianceData.indexOf(i)})" class="bg-white p-4 rounded-lg shadow-sm border border-slate-100 mb-2 flex justify-between items-center cursor-pointer hover:shadow-md transition">
                            <div>
                                <h4 class="font-bold text-sm text-slate-800">${i.title}</h4>
                                <span class="text-xs bg-brand-50 text-brand-700 px-2 rounded font-bold">${i.cat}</span>
                            </div>
                            <div class="text-right">
                                <div class="text-xs text-slate-400 font-bold uppercase">Due</div>
                                <div class="text-sm font-bold text-brand-600">${i.date}</div>
                            </div>
                        </div>
                    `).join('');
                    document.getElementById('resultsCount').innerText = displayList.length + " Found";
                }
            }
            document.getElementById('initialInstruction').classList.add('hidden');
            document.getElementById('tabsWrapper').classList.remove('hidden');
            
            if(window.innerWidth < 1024) document.getElementById('configSidebar').classList.add('-translate-x-full');
        },
        
        openModal(idx) {
             const item = complianceData[idx];
             if(item) {
                 document.getElementById('modalTitle').innerText = item.title;
                 document.getElementById('modalDesc').innerText = item.desc;
                 document.getElementById('modalDate').innerText = item.date;
                 document.getElementById('modalFreq').innerText = item.freq;
                 document.getElementById('infoModal').classList.remove('hidden');
             }
        },
        
        closeModal() {
             document.getElementById('infoModal').classList.add('hidden');
        },
        
        getPricing() {
            this.closeModal();
            router('pricing');
        },

        downloadCSV() { alert('Exporting Checklist...'); }
    };

    // --- 5. ENQUIRY MODAL LOGIC (Preserved) ---
    function openEnquiryModal(serviceName) {
        document.getElementById('enquiryServiceName').innerText = serviceName;
        document.getElementById('enquiryModal').classList.remove('hidden');
    }
    function closeEnquiryModal() {
        document.getElementById('enquiryModal').classList.add('hidden');
    }
    function switchPricing(cat) {
        // Correctly handle the ring classes for button state
        ['subscription','bookkeeping','litigation','advisory'].forEach(c => {
            const btn = document.getElementById(`tab-${c}`);
            if(c === cat) {
                // Active: Remove gray, add white bg + ring
                btn.classList.remove('text-gray-500', 'hover:text-gray-900'); 
                btn.classList.add('bg-white', 'text-gray-900', 'shadow-sm', 'ring-1', 'ring-black/5');
            } else {
                // Inactive: Add gray, remove white bg + ring
                btn.classList.add('text-gray-500', 'hover:text-gray-900'); 
                btn.classList.remove('bg-white', 'text-gray-900', 'shadow-sm', 'ring-1', 'ring-black/5');
            }
        });

        // Toggle content sections
        document.querySelectorAll('.pricing-content').forEach(el => el.classList.add('hidden-section'));
        const content = document.getElementById(`pricing-${cat}`);
        if(content) content.classList.remove('hidden-section');
    }

    // Init
    document.addEventListener('DOMContentLoaded', () => {
        // Initialize Firebase
        if (typeof firebase !== 'undefined') {
          try {
            firebase.initializeApp(firebaseConfig);
            // Optionally initialize other services like analytics or firestore if needed:
            // const db = firebase.firestore();
            // console.log("Firebase initialized");
          } catch (e) {
            console.error("Firebase initialization failed:", e);
          }
        }
        
        router('home');
    });

</script>
</body>
</html>